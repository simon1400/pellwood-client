{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect, useContext } from 'react';\nimport Link from 'next/link';\nimport { offcanvas } from 'uikit';\nimport translate from '../data/staticTranslate';\nimport { DataStateContext } from '../context/dataStateContext';\nimport localize from '../data/localize';\nimport { useRouter } from 'next/router';\n\nvar Canvas = function Canvas() {\n  var router = useRouter();\n\n  var _localize = localize(router.locale),\n      lang = _localize.lang,\n      currency = _localize.currency;\n\n  var _useContext = useContext(DataStateContext),\n      dataContextState = _useContext.dataContextState,\n      dataContextDispatch = _useContext.dataContextDispatch;\n\n  var _useState = useState(dataContextState.basket),\n      basket = _useState[0],\n      setBasket = _useState[1];\n\n  var _useState2 = useState(dataContextState.basketCount),\n      basketCount = _useState2[0],\n      setBasketCount = _useState2[1];\n\n  var _useState3 = useState(0),\n      sum = _useState3[0],\n      setSum = _useState3[1];\n\n  var _useState4 = useState(0),\n      sale = _useState4[0],\n      setSale = _useState4[1];\n\n  useEffect(function () {\n    setBasket(dataContextState.basket);\n    setBasketCount(dataContextState.basketCount);\n  }, [dataContextState.basketCount]);\n\n  var closeCanvas = function closeCanvas() {\n    offcanvas('#offcanvas-flip').hide();\n  };\n\n  var onSumItems = function onSumItems() {\n    var sumAll = 0,\n        sumItem = 0;\n\n    if (basket) {\n      basket.map(function (item, index) {\n        if (item.variantPrice instanceof String) {\n          sumItem = item.variantPrice.split(' ')[0] * item.countVariant;\n        } else {\n          sumItem = item.variantPrice * item.countVariant;\n        }\n\n        sumAll = +sumItem + sumAll;\n      });\n    }\n\n    if (lang === 'en' && sumAll > 150) {\n      setSale((Math.round(sumAll * 0.05 * 100) / 100).toFixed(2));\n      sumAll = sumAll - sumAll * 0.05;\n    } else if (lang === 'cz' && sumAll > 2000) {\n      setSale(Math.round(sumAll * 0.05));\n      sumAll = sumAll - sumAll * 0.05;\n    }\n\n    if (lang === 'en' && sumAll <= 150 || lang === 'cz' && sumAll <= 2000) {\n      setSale(0);\n    }\n\n    if (lang === 'en') {\n      setSum((Math.round(sumAll * 100) / 100).toFixed(2));\n    } else {\n      setSum(Math.round(sumAll));\n    }\n  };\n\n  useEffect(function () {\n    onSumItems();\n  }, []);\n  useEffect(function () {\n    setBasket(dataContextState.basket);\n    setBasketCount(dataContextState.basketCount);\n    onSumItems();\n  }, [router.query.length]);\n  useEffect(function () {\n    dataContextDispatch({\n      state: basket,\n      type: 'basket'\n    });\n    dataContextDispatch({\n      state: basketCount,\n      type: 'basketCount'\n    });\n  }, [basketCount]);\n\n  var deleteItem = function deleteItem(e) {\n    e.preventDefault();\n    basket.map(function (item, index) {\n      if (item.id === e.currentTarget.dataset.id && item.variantName === e.currentTarget.dataset.name) {\n        basket.splice(index, 1);\n      }\n    });\n    var newBasketCount = +basketCount - 1;\n    setBasketCount(newBasketCount);\n    setBasket(basket);\n  };\n\n  return __jsx(\"div\", {\n    id: \"offcanvas-flip\",\n    \"uk-offcanvas\": \"flip: true; overlay: true;\"\n  }, __jsx(\"div\", {\n    className: \"uk-offcanvas-bar\"\n  }, __jsx(\"div\", {\n    className: \"tm-canvas-head\"\n  }, __jsx(\"span\", {\n    className: \"tm-circle-count\"\n  }, basketCount ? basketCount : 0), __jsx(\"h2\", null, translate.basket[lang]), __jsx(Link, {\n    href: router.asPath\n  }, __jsx(\"a\", {\n    className: \"tm-canvas-close uk-close-large uk-close\",\n    \"uk-close\": \"\",\n    onClick: function onClick(e) {\n      return closeCanvas();\n    }\n  }))), basketCount && sum ? __jsx(\"div\", null, !!basket.length && basket.map(function (item, index) {\n    return __jsx(\"div\", {\n      key: index,\n      className: \"tm-canvas-basket-item-wrap\"\n    }, __jsx(\"div\", {\n      className: \"tm-basket-item\"\n    }, __jsx(\"div\", {\n      \"data-src\": item.imgUrl,\n      className: \"tm-basket-img-wrap uk-background-contain\",\n      \"uk-img\": \"\"\n    }), __jsx(\"div\", {\n      className: \"tm-basket-item-info\"\n    }, __jsx(\"h3\", {\n      className: \"tm-basket-item-head\"\n    }, item.nameProduct), __jsx(\"span\", null, item.variantName), __jsx(\"span\", null, item.variantPrice instanceof String ? item.variantPrice : item.variantPrice + ' ' + currency), __jsx(\"div\", {\n      className: \"tm-canvas-basket-item-count\"\n    }, __jsx(\"span\", null, item.countVariant, \" \", translate.pc[lang]), __jsx(Link, {\n      href: router.asPath + '?delete' + item.id + item.variantName\n    }, __jsx(\"a\", null, __jsx(\"button\", {\n      className: \"tm-canvas-item-remove\",\n      \"data-id\": item.id,\n      \"data-name\": item.variantName,\n      type: \"button\",\n      onClick: function onClick(e) {\n        return deleteItem(e);\n      },\n      \"uk-close\": \"\"\n    })))))));\n  }), __jsx(\"div\", {\n    className: \"tm-basket-total\"\n  }, __jsx(\"table\", {\n    className: \"uk-table uk-table-divider\"\n  }, __jsx(\"tbody\", null, __jsx(\"tr\", null, __jsx(\"td\", null, translate.delivery[lang]), __jsx(\"td\", null, __jsx(\"span\", {\n    className: \"\".concat(lang === 'en' && sum > 100 || lang === 'cz' && sum > 1500 && \"tm-positive\")\n  }, lang === 'cz' && sum <= 1500 && 'od 150 Kč', lang === 'en' && sum <= 100 && '10 €', lang === 'en' && sum > 100 && translate.free[lang], lang === 'cz' && sum > 1500 && translate.free[lang]))), (lang === 'cz' && sum <= 1500 || lang === 'en' && sum <= 100) && __jsx(\"tr\", null, __jsx(\"td\", null, translate.deliveryFreeCanvas[lang]), __jsx(\"td\", null, translate.deliveryFreeCanvasValue[lang])), (lang === 'cz' && sum <= 2000 || lang === 'en' && sum <= 150) && __jsx(\"tr\", null, __jsx(\"td\", null, translate.saleCanvas[lang]), __jsx(\"td\", null, translate.saleCanvasValue[lang])), sale > 0 && __jsx(\"tr\", null, __jsx(\"td\", null, translate.sale[lang]), __jsx(\"td\", null, \"-\", sale, \" \", currency)), __jsx(\"tr\", null, __jsx(\"td\", null, translate.totalprice[lang]), __jsx(\"td\", null, sum, \" \", currency))))), __jsx(\"div\", {\n    className: \"tm-basket-footer\"\n  }, __jsx(Link, {\n    href: \"/basket\",\n    onClick: function onClick() {\n      return closeCanvas();\n    }\n  }, __jsx(\"a\", {\n    className: \"tm-button tm-bare-button\"\n  }, translate.basket[lang])), __jsx(Link, {\n    href: \"/basket/checkout\",\n    onClick: function onClick() {\n      return closeCanvas();\n    }\n  }, __jsx(\"a\", {\n    className: \"tm-button tm-black-button\"\n  }, translate.checkout[lang])))) : __jsx(\"p\", {\n    className: \"uk-text-center\"\n  }, translate.emptybasket[lang])));\n};\n\nexport default Canvas;","map":null,"metadata":{},"sourceType":"module"}