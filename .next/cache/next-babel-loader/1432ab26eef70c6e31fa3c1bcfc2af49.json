{"ast":null,"code":"var _jsxFileName = \"/Users/dmytropechunka/Desktop/work/pellwood/client/pages/produkty/index.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport { modal, util } from 'uikit';\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport Cart from '../../components/Cart';\nimport SubMenu from '../../components/SubMenu';\nimport sanityClient from \"../../lib/sanity.js\";\nimport ModalFilter from '../../components/ModalFilter';\nimport translate from '../../data/staticTranslate';\n\nconst Catalog = ({\n  category,\n  settings,\n  articleFirst,\n  articleSeccond,\n  lang,\n  currency\n}) => {\n  _s();\n\n  var _settings$metaCatalog, _settings$metaCatalog2;\n\n  const {\n    0: product,\n    1: setProduct\n  } = useState([]);\n  const {\n    0: filtered,\n    1: setFiltered\n  } = useState(false);\n  const {\n    0: resetFilter\n  } = useState('');\n  const {\n    0: search,\n    1: setSearch\n  } = useState('');\n  const {\n    0: urlProduct,\n    1: setUrlProduct\n  } = useState(`*[_type == \"product\"].${lang}`);\n  const {\n    0: stateRange,\n    1: setStateRange\n  } = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  });\n  const {\n    0: rangeNumber,\n    1: setRangeNumber\n  } = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  });\n  useEffect(() => {\n    sanityClient.fetch(`${urlProduct} | order(sort asc, title asc)`).then(data => {\n      let filteredProduct = data.filter(item => item === null || item === void 0 ? void 0 : item.title);\n\n      if (lang === 'en') {\n        filteredProduct.map(item => {\n          var _item$variants;\n\n          if (typeof item.price === 'string') {\n            item.price.replace(/,/g, '.');\n          } else if ((_item$variants = item.variants) === null || _item$variants === void 0 ? void 0 : _item$variants.length) {\n            item.variants = item.variants.map(variant => {\n              variant.price = variant.price.replace(/,/g, '.');\n              return variant;\n            });\n          }\n        });\n      }\n\n      setProduct(filteredProduct);\n      const lengthNumbers = [],\n            diameterNumbers = [];\n      var length = undefined,\n          diameter = undefined;\n\n      for (var i = 0; i < filteredProduct.length; i++) {\n        var _filteredProduct$i;\n\n        if ((_filteredProduct$i = filteredProduct[i]) === null || _filteredProduct$i === void 0 ? void 0 : _filteredProduct$i.parametrs) {\n          var _filteredProduct$i2, _filteredProduct$i3;\n\n          length = (_filteredProduct$i2 = filteredProduct[i]) === null || _filteredProduct$i2 === void 0 ? void 0 : _filteredProduct$i2.parametrs.find(o => o.title === 'Délka' || o.title === 'Length');\n          diameter = (_filteredProduct$i3 = filteredProduct[i]) === null || _filteredProduct$i3 === void 0 ? void 0 : _filteredProduct$i3.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter');\n\n          if (length) {\n            lengthNumbers.push(+length.value.substr(0, length.value.length - 3).split(',').join('.'));\n          }\n\n          if (diameter) {\n            diameterNumbers.push(+diameter.value.substr(0, diameter.value.length - 3).split(',').join('.'));\n          }\n        }\n      }\n\n      const rangeNum = {\n        length: {\n          min: Math.min(...lengthNumbers),\n          max: Math.max(...lengthNumbers)\n        },\n        diameter: {\n          min: Math.min(...diameterNumbers),\n          max: Math.max(...diameterNumbers)\n        }\n      };\n      setRangeNumber(rangeNum);\n      setStateRange(rangeNum);\n    });\n  }, []);\n\n  const closeModal = () => {\n    modal(util.find('#modal-filter')).hide();\n  };\n\n  const handleFilter = e => {\n    e.preventDefault();\n    const newUrlProduct = `*[_type == \"product\" ${!!search.length ? '&& ' + lang + '.title match \"' + search.split(/[,-]+/).join(' ') + '*\"' : ''}].${lang}`;\n    setUrlProduct(newUrlProduct);\n    const searchQuery = `${newUrlProduct} | order(sort asc, title asc)`;\n    sanityClient.fetch(searchQuery).then(data => {\n      const filteredProduct = data.filter(item => item === null || item === void 0 ? void 0 : item.title);\n      const filteredProdParameters = [];\n      var length = undefined,\n          diameter = undefined,\n          lengthNum = 0,\n          diameterNum = 0;\n\n      for (var i = 0; i < filteredProduct.length; i++) {\n        var _filteredProduct$i4;\n\n        if ((_filteredProduct$i4 = filteredProduct[i]) === null || _filteredProduct$i4 === void 0 ? void 0 : _filteredProduct$i4.parametrs) {\n          var _filteredProduct$i5, _filteredProduct$i6;\n\n          length = (_filteredProduct$i5 = filteredProduct[i]) === null || _filteredProduct$i5 === void 0 ? void 0 : _filteredProduct$i5.parametrs.find(o => o.title === 'Délka' || o.title === 'Length');\n          diameter = (_filteredProduct$i6 = filteredProduct[i]) === null || _filteredProduct$i6 === void 0 ? void 0 : _filteredProduct$i6.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter');\n\n          if (length || diameter) {\n            if (length) {\n              lengthNum = +length.value.substr(0, length.value.length - 3).split(',').join('.');\n            }\n\n            if (diameter) {\n              diameterNum = +diameter.value.substr(0, diameter.value.length - 3).split(',').join('.');\n            }\n\n            if (lengthNum <= stateRange.length.max && lengthNum >= stateRange.length.min && diameterNum <= stateRange.diameter.max && diameterNum >= stateRange.diameter.min) {\n              filteredProdParameters.push(filteredProduct[i]);\n            }\n          }\n        }\n      }\n\n      setProduct(filteredProdParameters);\n    });\n    closeModal();\n    setFiltered(true);\n  };\n\n  const cancelFilter = async e => {\n    e.preventDefault();\n    setFiltered(false);\n    setStateRange(rangeNumber);\n    setSearch('');\n    setUrlProduct(`*[_type == \"product\"].${lang}`);\n    const data = await sanityClient.fetch(`*[_type == \"product\"].${lang} | order(sort asc) | order(title asc)`);\n    setProduct(data);\n  };\n\n  return __jsx(Page, {\n    id: \"catalog\",\n    title: (_settings$metaCatalog = settings.metaCatalog) === null || _settings$metaCatalog === void 0 ? void 0 : _settings$metaCatalog.title,\n    description: (_settings$metaCatalog2 = settings.metaCatalog) === null || _settings$metaCatalog2 === void 0 ? void 0 : _settings$metaCatalog2.description,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 5\n    }\n  }, (settings === null || settings === void 0 ? void 0 : settings.titleCategory) && __jsx(\"section\", {\n    className: \"head_category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 35\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-container uk-container-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"content_head_wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 11\n    }\n  }, __jsx(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  }, settings.titleCategory), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }\n  }, settings.descriptionCategory)))), __jsx(\"section\", {\n    className: \"category grey\",\n    id: \"catalog-short\",\n    \"uk-filter\": \"target: .js-filter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-container uk-container-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"category_menu uk-flex uk-flex-between uk-flex-middle uk-flex-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-flex uk-flex-middle uk-width-1-1 uk-flex-between uk-flex-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"filter-controls-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 15\n    }\n  }, __jsx(\"a\", {\n    className: \"tm-button tm-black-button\",\n    href: \"#modal-filter\",\n    \"uk-toggle\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 17\n    }\n  }, translate.searchAndFilter[lang]), filtered && __jsx(\"button\", {\n    className: \"cancel-filtered tm-button tm-button-text\",\n    onClick: e => cancelFilter(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 30\n    }\n  }, __jsx(\"img\", {\n    src: \"/assets/times.svg\",\n    alt: \"Cancel filter\",\n    \"uk-svg\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 19\n    }\n  }), \"Zru\\u0161it v\\u0161echny filtry\")), __jsx(SubMenu, {\n    data: category,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 15\n    }\n  })))), __jsx(\"div\", {\n    className: \"uk-container uk-container-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }\n  }, __jsx(\"ul\", {\n    className: `js-filter uk-grid uk-child-width-1-1 uk-child-width-1-3@m uk-child-width-1-2@s${resetFilter ? ' show-all' : ''}`,\n    \"uk-grid\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, !!product.length && product.map((item, index) => __jsx(Cart, {\n    item: item,\n    key: index,\n    lang: lang,\n    currency: currency,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 63\n    }\n  }))))), __jsx(RandomArticles, {\n    lang: lang,\n    articleFirst: articleFirst,\n    articleSeccond: articleSeccond,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }\n  }), __jsx(ModalFilter, {\n    setSearch: setSearch,\n    search: search,\n    lang: lang,\n    closeModal: closeModal,\n    setStateRange: setStateRange,\n    handleFilter: handleFilter,\n    rangeNumber: rangeNumber,\n    stateRange: stateRange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }\n  }));\n};\n\n_s(Catalog, \"mJNRMCTKxo14GeDXqgDUMSLWlG0=\");\n\n_c = Catalog;\nexport var __N_SSP = true;\nexport default Catalog;\n\nvar _c;\n\n$RefreshReg$(_c, \"Catalog\");","map":{"version":3,"sources":["/Users/dmytropechunka/Desktop/work/pellwood/client/pages/produkty/index.js"],"names":["useState","useEffect","modal","util","Page","RandomArticles","Cart","SubMenu","sanityClient","ModalFilter","translate","Catalog","category","settings","articleFirst","articleSeccond","lang","currency","product","setProduct","filtered","setFiltered","resetFilter","search","setSearch","urlProduct","setUrlProduct","stateRange","setStateRange","length","min","max","diameter","rangeNumber","setRangeNumber","fetch","then","data","filteredProduct","filter","item","title","map","price","replace","variants","variant","lengthNumbers","diameterNumbers","undefined","i","parametrs","find","o","push","value","substr","split","join","rangeNum","Math","closeModal","hide","handleFilter","e","preventDefault","newUrlProduct","searchQuery","filteredProdParameters","lengthNum","diameterNum","cancelFilter","metaCatalog","description","titleCategory","descriptionCategory","searchAndFilter","index"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react';\nimport {modal, util} from 'uikit'\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport Cart from '../../components/Cart';\nimport SubMenu from '../../components/SubMenu';\nimport sanityClient from \"../../lib/sanity.js\";\nimport ModalFilter from '../../components/ModalFilter'\nimport translate from '../../data/staticTranslate'\nimport localize from '../../data/localize'\n\nexport async function getServerSideProps({locale}) {\n  const {lang, currency} = localize(locale)\n\n  const query = `{\n    'product': *[_type == \"product\"].${lang} | order(${lang}.sort asc) | order(${lang}.title asc),\n    'category': *[_type == \"category\"] | order(${lang}.sort asc),\n    'articles': *[_type == \"article\"] | order(${lang}.sort asc),\n    'settings': *[_type == \"settings\"].${lang}\n  }`;\n\n  const data = await sanityClient.fetch(query)\n\n  const shuffle = (a, count) => {\n    for (let i = a.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a\n  }\n\n  const articleFirst = shuffle(data.articles.filter(item => item[lang]?.category._ref.includes(\"3252355e-13f2-4628-8db4-a90bb522713b\")), 0)\n  const articleSeccond = shuffle(data.articles.filter(item => item[lang]?.category._ref.includes(\"53b17b89-299c-48b1-b332-26240fc0e624\")), 1)\n  const category = data.category.filter(item => item?._id)\n  const settings = data.settings.filter(item => item?.titleCategory)?.[0]\n\n  return {\n    props: {\n      category,\n      settings,\n      articleFirst,\n      articleSeccond,\n      lang,\n      currency\n    }\n  }\n}\n\nconst Catalog = ({\n  category,\n  settings,\n  articleFirst,\n  articleSeccond,\n  lang,\n  currency\n}) => {\n\n  const [product, setProduct] = useState([])\n  const [filtered, setFiltered] = useState(false)\n  const [resetFilter] = useState('')\n  const [search, setSearch] = useState('')\n  const [urlProduct, setUrlProduct] = useState(`*[_type == \"product\"].${lang}`)\n\n  const [stateRange, setStateRange] = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  })\n\n  const [rangeNumber, setRangeNumber] = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  })\n\n  useEffect(() => {\n    sanityClient.fetch(`${urlProduct} | order(sort asc, title asc)`).then(data => {\n\n      let filteredProduct = data.filter(item => item?.title)\n      if(lang === 'en'){\n        filteredProduct.map(item => {\n          if(typeof item.price === 'string'){\n            item.price.replace(/,/g, '.')\n          }else if(item.variants?.length){\n            item.variants = item.variants.map(variant => {\n              variant.price = variant.price.replace(/,/g, '.')\n              return variant\n            })\n          }\n        })\n      }\n\n      setProduct(filteredProduct)\n\n      const lengthNumbers = [], diameterNumbers = []\n      var length = undefined, diameter = undefined;\n\n      for(var i = 0; i < filteredProduct.length; i++){\n        if(filteredProduct[i]?.parametrs){\n          length = filteredProduct[i]?.parametrs.find(o => o.title === 'Délka' || o.title === 'Length')\n          diameter = filteredProduct[i]?.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter')\n          if(length){\n            lengthNumbers.push(+length.value.substr(0, length.value.length - 3).split(',').join('.'))\n          }\n          if(diameter){\n            diameterNumbers.push(+diameter.value.substr(0, diameter.value.length - 3).split(',').join('.'))\n          }\n        }\n      }\n      const rangeNum = {\n        length: {\n          min: Math.min(...lengthNumbers),\n          max: Math.max(...lengthNumbers)\n        },\n        diameter: {\n          min: Math.min(...diameterNumbers),\n          max: Math.max(...diameterNumbers)\n        }\n      }\n\n      setRangeNumber(rangeNum)\n      setStateRange(rangeNum)\n    })\n  }, [])\n\n\n\n  const closeModal = () => {\n    modal(util.find('#modal-filter')).hide();\n  }\n\n  const handleFilter = (e) => {\n    e.preventDefault()\n\n    const newUrlProduct = `*[_type == \"product\" ${!!search.length ? '&& '+lang+'.title match \"'+ search.split(/[,-]+/).join(' ') +'*\"' : ''}].${lang}`\n    setUrlProduct(newUrlProduct)\n    const searchQuery = `${newUrlProduct} | order(sort asc, title asc)`\n    sanityClient.fetch(searchQuery).then(data => {\n      const filteredProduct = data.filter(item => item?.title)\n      const filteredProdParameters = []\n      var length = undefined, diameter = undefined, lengthNum = 0, diameterNum = 0;\n\n      for(var i = 0; i < filteredProduct.length; i++){\n        if(filteredProduct[i]?.parametrs){\n          length = filteredProduct[i]?.parametrs.find(o => o.title === 'Délka' || o.title === 'Length')\n          diameter = filteredProduct[i]?.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter')\n\n          if(length || diameter){\n            if(length){\n              lengthNum = +length.value.substr(0, length.value.length - 3).split(',').join('.')\n            }\n            if(diameter){\n              diameterNum = +diameter.value.substr(0, diameter.value.length - 3).split(',').join('.')\n            }\n            if(lengthNum <= stateRange.length.max\n              && lengthNum >= stateRange.length.min\n              && diameterNum <= stateRange.diameter.max\n              && diameterNum >= stateRange.diameter.min){\n                filteredProdParameters.push(filteredProduct[i])\n            }\n          }\n        }\n      }\n      setProduct(filteredProdParameters)\n    })\n    closeModal()\n    setFiltered(true)\n  }\n\n\n  const cancelFilter = async (e) => {\n    e.preventDefault()\n    setFiltered(false)\n    setStateRange(rangeNumber)\n    setSearch('')\n    setUrlProduct(`*[_type == \"product\"].${lang}`)\n    const data = await sanityClient.fetch(`*[_type == \"product\"].${lang} | order(sort asc) | order(title asc)`)\n    setProduct(data)\n  }\n\n  return (\n    <Page id=\"catalog\" title={settings.metaCatalog?.title} description={settings.metaCatalog?.description}>\n      {settings?.titleCategory && <section className=\"head_category\">\n        <div className=\"uk-container uk-container-expand\">\n          <div className=\"content_head_wrap\">\n            <h1>{settings.titleCategory}</h1>\n            <p>{settings.descriptionCategory}</p>\n          </div>\n        </div>\n      </section>}\n\n\n      <section className=\"category grey\" id=\"catalog-short\" uk-filter=\"target: .js-filter\">\n        <div className=\"uk-container uk-container-expand\">\n          <div className=\"category_menu uk-flex uk-flex-between uk-flex-middle uk-flex-wrap\">\n            <div className=\"uk-flex uk-flex-middle uk-width-1-1 uk-flex-between uk-flex-wrap\">\n              <div className=\"filter-controls-wrap\">\n                <a className=\"tm-button tm-black-button\" href=\"#modal-filter\" uk-toggle=\"\">{translate.searchAndFilter[lang]}</a>\n                {filtered && <button className=\"cancel-filtered tm-button tm-button-text\" onClick={e => cancelFilter(e)}>\n                  <img src=\"/assets/times.svg\" alt=\"Cancel filter\" uk-svg=\"\" />\n                  Zrušit všechny filtry\n                </button>}\n              </div>\n              <SubMenu data={category}/>\n            </div>\n          </div>\n        </div>\n        <div className=\"uk-container uk-container-expand\">\n          <ul className={`js-filter uk-grid uk-child-width-1-1 uk-child-width-1-3@m uk-child-width-1-2@s${resetFilter ? ' show-all' : ''}`} uk-grid=\"\">\n            {!!product.length && product.map((item, index) => <Cart item={item} key={index} lang={lang} currency={currency} />)}\n          </ul>\n        </div>\n      </section>\n\n      <RandomArticles lang={lang} articleFirst={articleFirst} articleSeccond={articleSeccond}/>\n\n      <ModalFilter\n        setSearch={setSearch}\n        search={search}\n        lang={lang}\n        closeModal={closeModal}\n        setStateRange={setStateRange}\n        handleFilter={handleFilter}\n        rangeNumber={rangeNumber}\n        stateRange={stateRange} />\n\n    </Page>\n  )\n}\n\nexport default Catalog\n"]},"metadata":{},"sourceType":"module"}