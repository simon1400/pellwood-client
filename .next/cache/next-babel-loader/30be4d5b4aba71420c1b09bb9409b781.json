{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect, useContext } from 'react';\nimport AnimateHeight from 'react-animate-height';\nimport Delivery from '../../components/user/delivery.js';\nimport Corporate from '../../components/user/corporate.js';\nimport { DataStateContext } from '../../context/dataStateContext';\nimport { AxiosAPI } from '../../restClient';\nimport translate from '../../data/staticTranslate';\nimport validationForm from '../../functionss/validationForm';\nimport localize from '../../data/localize';\n\nvar _localize = localize(window.location.href),\n    lang = _localize.lang,\n    currency = _localize.currency;\n\nvar User = function User() {\n  var _useContext = useContext(DataStateContext),\n      dataContextState = _useContext.dataContextState,\n      dataContextDispatch = _useContext.dataContextDispatch;\n\n  var _useState = useState(dataContextState.user),\n      user = _useState[0];\n\n  var _useState2 = useState([]),\n      orders = _useState2[0],\n      setOrders = _useState2[1];\n\n  var state = useState({\n    email: user.email,\n    phone: user.phone,\n    name: user.name,\n    surname: user.surname,\n    country: user.country,\n    city: user.city,\n    address: user.address,\n    code: user.code,\n    anotherAddressCheck: false,\n    companyDataCheck: false\n  });\n\n  var _useState3 = useState({\n    email: false,\n    phone: false,\n    name: false,\n    surname: false,\n    city: false,\n    address: false,\n    code: false\n  }),\n      error = _useState3[0],\n      setError = _useState3[1];\n\n  var anotherAdress = useState(_objectSpread({}, user.anotherAdress));\n  var companyData = useState(_objectSpread({}, user.companyData));\n  useEffect(function () {\n    AxiosAPI.get(\"\".concat(process.env.REACT_APP_API, \"/order/\").concat(state[0].email)).then(function (res) {\n      setOrders(res.data.data);\n    });\n  }, []);\n\n  var handleChange = function handleChange(name, value) {\n    var newState = state[0];\n    newState[name] = value;\n    state[1](_objectSpread({}, newState));\n  };\n\n  var onSave = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var saveData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (state[0].address.length) {\n                _context.next = 5;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                address: true\n              }));\n              return _context.abrupt(\"return\");\n\n            case 5:\n              if (state[0].city.length) {\n                _context.next = 10;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                city: true\n              }));\n              return _context.abrupt(\"return\");\n\n            case 10:\n              if (state[0].surname.length) {\n                _context.next = 15;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                surname: true\n              }));\n              return _context.abrupt(\"return\");\n\n            case 15:\n              if (state[0].name.length) {\n                _context.next = 20;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                name: true\n              }));\n              return _context.abrupt(\"return\");\n\n            case 20:\n              if (state[0].phone.length) {\n                _context.next = 25;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                phone: true\n              }));\n              return _context.abrupt(\"return\");\n\n            case 25:\n              if (state[0].code.length) {\n                _context.next = 28;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                code: true\n              }));\n              return _context.abrupt(\"return\");\n\n            case 28:\n              if (!onBlur('email')) {\n                _context.next = 30;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 30:\n              saveData = _objectSpread(_objectSpread({\n                id: user._id\n              }, state[0]), {}, {\n                anotherAdress: anotherAdress[0],\n                companyData: companyData[0]\n              });\n              _context.next = 33;\n              return AxiosAPI.put(\"\".concat(process.env.REACT_APP_API, \"/user\"), {\n                data: saveData,\n                type: 'update'\n              }).then(function (res) {\n                dataContextDispatch({\n                  state: res.data.data,\n                  type: 'user'\n                });\n              }).catch(function (err) {\n                console.log(err);\n              });\n\n            case 33:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSave(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var onLogout = function onLogout() {\n    dataContextDispatch({\n      state: null,\n      type: 'user'\n    });\n    localStorage.removeItem('user');\n    window.location.href = \"/\".concat(lang === 'en' ? 'en' : '');\n  };\n\n  var onBlur = function onBlur(type) {\n    if (validationForm(type, state[0], error, setError)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  return __jsx(\"main\", {\n    className: \"basket user\"\n  }, __jsx(\"div\", {\n    className: \"tm-basket-content-wrap\"\n  }, __jsx(\"div\", {\n    className: \"tm-basket-content\"\n  }, __jsx(\"div\", {\n    className: \"tm-basket-head\"\n  }, __jsx(\"h1\", null, translate.yourAccount[lang])), __jsx(Delivery, {\n    state: state[0],\n    setState: state[1],\n    error: error,\n    setError: setError,\n    onBlur: onBlur\n  }), __jsx(\"div\", {\n    className: \"uk-margin-small checkbox_item\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"checkbox_firm_data\",\n    onChange: function onChange() {\n      return handleChange('companyDataCheck', !state[0].companyDataCheck);\n    },\n    checked: state[0].companyDataCheck\n  }), __jsx(\"label\", {\n    htmlFor: \"checkbox_firm_data\"\n  }), __jsx(\"label\", {\n    htmlFor: \"checkbox_firm_data\"\n  }, translate.checkcompanydata[lang])), __jsx(AnimateHeight, {\n    duration: 500,\n    height: state[0].companyDataCheck ? 'auto' : 0\n  }, __jsx(Corporate, {\n    state: companyData[0],\n    setState: companyData[1]\n  })), __jsx(\"hr\", null), __jsx(\"div\", {\n    className: \"form_column\"\n  }, __jsx(\"div\", null, __jsx(\"button\", {\n    className: \"tm-button tm-bare-button\",\n    onClick: function onClick() {\n      return onLogout();\n    }\n  }, translate.logOut[lang])), __jsx(\"div\", {\n    className: \"uk-text-right\"\n  }, __jsx(\"button\", {\n    className: \"tm-button tm-black-button\",\n    onClick: function onClick(e) {\n      return onSave();\n    }\n  }, translate.save[lang]))))), __jsx(\"div\", {\n    className: \"basket-right-panel\"\n  }, __jsx(\"div\", {\n    className: \"basket-right-content\"\n  }, __jsx(\"div\", {\n    className: \"last_order_wrap tm-total-end\"\n  }, __jsx(\"table\", {\n    className: \"uk-table uk-table-small uk-table-divider\"\n  }, __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", {\n    colSpan: \"2\"\n  }, translate.orderHistory[lang]))), __jsx(\"tbody\", null, (orders === null || orders === void 0 ? void 0 : orders.length) ? orders.map(function (item) {\n    return __jsx(\"tr\", {\n      key: item._id\n    }, __jsx(\"td\", null, translate.orderNumber[lang], \" \", item.idOrder), __jsx(\"td\", {\n      className: \"uk-text-right\"\n    }, item.sum, \" \", ' ' + currency));\n  }) : __jsx(\"tr\", null, __jsx(\"td\", null, translate.noOrder[lang]), __jsx(\"td\", {\n    className: \"uk-text-right\"\n  }))))))));\n};\n\nexport default User;","map":null,"metadata":{},"sourceType":"module"}