{"ast":null,"code":"import _defineProperty from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/dmytropechunka/Desktop/work/pellwood/client/pages/produkt/[product].js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useContext } from 'react';\nimport BlockContent from \"@sanity/block-content-to-react\";\nimport imageUrlBuilder from \"@sanity/image-url\";\nimport { dropdown, offcanvas } from 'uikit';\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport ShortBlock from '../../components/SmallShortCart';\nimport sanityClient from \"../../lib/sanity.js\";\nimport translate from '../../data/staticTranslate';\nimport { DataStateContext } from '../../context/dataStateContext';\nconst imageBuilder = imageUrlBuilder(sanityClient);\n\nconst urlFor = source => imageBuilder.image(source);\n\nconst Product = ({\n  carts,\n  articleFirst,\n  articleSeccond,\n  product,\n  productId,\n  lang,\n  currency\n}) => {\n  _s();\n\n  var _product$variants4, _product$variants5, _product$variants6;\n\n  const {\n    0: count,\n    1: setCount\n  } = useState(1);\n  const {\n    0: loader,\n    1: setLoader\n  } = useState(false);\n  const {\n    dataContextState,\n    dataContextDispatch\n  } = useContext(DataStateContext);\n  const {\n    0: select,\n    1: setSelect\n  } = useState({\n    name: translate.selectvariant[lang],\n    price: ''\n  });\n  const {\n    0: error,\n    1: setError\n  } = useState({\n    select: false,\n    count: false\n  });\n\n  const selectHandle = (name, price) => {\n    setSelect(_objectSpread(_objectSpread({}, select), {}, {\n      name,\n      price\n    }));\n    setError(_objectSpread(_objectSpread({}, error), {}, {\n      select: false\n    }));\n    dropdown(\".select-variant\").hide();\n  };\n\n  const onBuy = () => {\n    var _product$variants, _product$variants2;\n\n    setLoader(true);\n\n    if (select.name === translate.selectvariant[lang] && (product === null || product === void 0 ? void 0 : (_product$variants = product.variants) === null || _product$variants === void 0 ? void 0 : _product$variants.length)) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        select: true\n      }));\n      setLoader(false);\n      history.push({\n        search: ''\n      });\n      return;\n    }\n\n    if (count === 0) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        count: true\n      }));\n      setLoader(false);\n      history.push({\n        search: ''\n      });\n      return;\n    }\n\n    history.push({\n      search: '?buy=true'\n    });\n    var newBasketItem = {\n      id: productId,\n      nameProduct: product.title,\n      variantName: select.name,\n      variantPrice: select.price,\n      countVariant: count,\n      imgUrl: urlFor(product.image).url()\n    };\n\n    if (!(product === null || product === void 0 ? void 0 : (_product$variants2 = product.variants) === null || _product$variants2 === void 0 ? void 0 : _product$variants2.length)) {\n      newBasketItem.variantName = product.title;\n\n      if (typeof product.price === 'string') {\n        newBasketItem.variantPrice = product.price;\n      } else {\n        newBasketItem.variantPrice = product.price;\n      }\n    } else {\n      newBasketItem.variantName = select.name;\n      newBasketItem.variantPrice = select.price;\n    }\n\n    let basket = dataContextState.basket;\n    let basketCount = dataContextState.basketCount;\n\n    if (basket === undefined || basket === null || !basket) {\n      basket = [];\n      basket.push(newBasketItem);\n      basketCount = 1;\n    } else {\n      let indexBasket = -1;\n      basket.map((item, index) => {\n        var _product$variants3;\n\n        if (product === null || product === void 0 ? void 0 : (_product$variants3 = product.variants) === null || _product$variants3 === void 0 ? void 0 : _product$variants3.length) {\n          if (item.id === productId && basket[index].variantName === select.name) {\n            indexBasket = index;\n          }\n        } else if (item.id === productId) {\n          indexBasket = index;\n        }\n      });\n\n      if (indexBasket >= 0) {\n        basket[indexBasket].countVariant = +basket[indexBasket].countVariant + count;\n      } else {\n        basketCount = +basketCount + 1;\n        basket.push(newBasketItem);\n      }\n\n      indexBasket = -1;\n    }\n\n    dataContextDispatch({\n      state: basket,\n      type: 'basket'\n    });\n    dataContextDispatch({\n      state: basketCount,\n      type: 'basketCount'\n    });\n    offcanvas('#offcanvas-flip').show();\n    setLoader(false);\n  };\n\n  return __jsx(Page, {\n    id: \"product\",\n    description: product.descriptionHead,\n    title: product.titleHead,\n    image: product.orientedImage ? urlFor(product.image).orientation(270).url() : urlFor(product.image).url(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 5\n    }\n  }, __jsx(\"section\", {\n    className: \"full product\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-grid uk-child-width-1-1 uk-child-width-1-2@m\",\n    \"uk-grid\": \"\",\n    \"uk-height-match\": \"target: > div > div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: `article_img_wrap ${product.orientedImage && 'scale_img'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-visible@m\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 15\n    }\n  }, product.orientedImage ? __jsx(\"img\", {\n    src: urlFor(product.image).orientation(270).url(),\n    alt: product.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 21\n    }\n  }) : __jsx(\"img\", {\n    src: urlFor(product.image).url(),\n    alt: product.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    className: `uk-hidden@m ${product.orientedImage && 'orianted-img'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }\n  }, product.orientedImage ? __jsx(\"img\", {\n    src: urlFor(product.image).orientation(180).url(),\n    alt: product.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 42\n    }\n  }) : __jsx(\"img\", {\n    src: urlFor(product.image).url(),\n    alt: product.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 19\n    }\n  })))), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"content_wrap grey\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 15\n    }\n  }, __jsx(\"h1\", {\n    className: \"head_1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 17\n    }\n  }, product.title), !!(product === null || product === void 0 ? void 0 : (_product$variants4 = product.variants) === null || _product$variants4 === void 0 ? void 0 : _product$variants4.length) && __jsx(\"div\", {\n    className: \"variants_list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 49\n    }\n  }, product.variants.map((item, index) => {\n    if (item.price) {\n      return __jsx(\"div\", {\n        key: index,\n        className: \"uk-grid uk-grid-medium\",\n        \"uk-grid\": \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 30\n        }\n      }, __jsx(\"div\", {\n        className: \"uk-width-expand\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 25\n        }\n      }, item.title), __jsx(\"div\", {\n        className: \"short_price\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 25\n        }\n      }, lang === 'en' ? (Math.round(+item.price * 100) / 100).toFixed(2) : item.price, \" \", currency));\n    }\n\n    return '';\n  })), !!(product === null || product === void 0 ? void 0 : (_product$variants5 = product.variants) === null || _product$variants5 === void 0 ? void 0 : _product$variants5[0].price) && __jsx(\"div\", {\n    className: \"order_block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 52\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-flex uk-flex-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-width-1-1 uk-width-auto@m\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: \"custom-select-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 23\n    }\n  }, __jsx(\"button\", {\n    className: `custom-select uk-button uk-button-default ${error.select && 'error'}`,\n    type: \"button\",\n    tabIndex: \"-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 25\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 27\n    }\n  }, select.name), __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 27\n    }\n  }, __jsx(\"img\", {\n    src: \"/assets/chevron-down-light.svg\",\n    alt: \"Down\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 33\n    }\n  }))), __jsx(\"div\", {\n    className: \"uk-dropdown select-variant\",\n    \"uk-dropdown\": \"mode: click; pos: bottom-justify; offset: 0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 25\n    }\n  }, __jsx(\"ul\", {\n    className: \"uk-nav uk-dropdown-nav\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 27\n    }\n  }, ((product === null || product === void 0 ? void 0 : product.variants) || []).map((item, index) => __jsx(Variant, {\n    key: index,\n    lang: lang,\n    currency: currency,\n    handle: selectHandle,\n    name: item.title,\n    price: item.price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 77\n    }\n  })))))), __jsx(\"div\", {\n    className: `custom_number quantity ${error.count && 'error'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 21\n    }\n  }, __jsx(\"input\", {\n    type: \"number\",\n    min: \"1\",\n    max: \"1000\",\n    step: \"1\",\n    onChange: e => setCount(+e.target.value),\n    value: count,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 23\n    }\n  }), __jsx(\"div\", {\n    className: \"quantity-nav\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 23\n    }\n  }, __jsx(\"div\", {\n    className: \"quantity-button quantity-up\",\n    onClick: () => setCount(count + 1),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 25\n    }\n  }, \"+\"), __jsx(\"div\", {\n    className: \"quantity-button quantity-down\",\n    onClick: () => {\n      if (count > 0) {\n        return setCount(count - 1);\n      } else {\n        return false;\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 25\n    }\n  }, \"-\")))), __jsx(\"button\", {\n    className: \"uk-width-1-1 uk-margin-top tm-button tm-black-button\",\n    onClick: () => onBuy(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 19\n    }\n  }, loader && __jsx(\"div\", {\n    \"uk-spinner\": \"\",\n    className: \"uk-icon uk-spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 32\n    }\n  }), translate.addToBasket[lang])), !(product === null || product === void 0 ? void 0 : (_product$variants6 = product.variants) === null || _product$variants6 === void 0 ? void 0 : _product$variants6.length) && __jsx(\"div\", {\n    className: \"tm-single-order\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 48\n    }\n  }, __jsx(\"div\", {\n    className: \"tm-single-price uk-text-center uk-margin-bottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 19\n    }\n  }, currency === '$' && currency, \" \", product.price, \" \", currency !== '$' && currency), __jsx(\"div\", {\n    className: \"uk-grid-small uk-grid\",\n    \"uk-grid\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-width-1-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: `custom_number quantity ${error.count && 'error'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 23\n    }\n  }, __jsx(\"input\", {\n    type: \"number\",\n    min: \"1\",\n    max: \"1000\",\n    step: \"1\",\n    onChange: e => setCount(+e.target.value),\n    value: count,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 25\n    }\n  }), __jsx(\"div\", {\n    className: \"quantity-nav\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 25\n    }\n  }, __jsx(\"div\", {\n    className: \"quantity-button quantity-up\",\n    onClick: () => setCount(count + 1),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 27\n    }\n  }, \"+\"), __jsx(\"div\", {\n    className: \"quantity-button quantity-down\",\n    onClick: () => {\n      if (count > 0) {\n        return setCount(count - 1);\n      } else {\n        return false;\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 27\n    }\n  }, \"-\")))), __jsx(\"div\", {\n    className: \"uk-width-2-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 21\n    }\n  }, __jsx(\"button\", {\n    className: \"uk-width-1-1 tm-button tm-black-button\",\n    onClick: () => onBuy(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 23\n    }\n  }, loader && __jsx(\"div\", {\n    \"uk-spinner\": \"\",\n    className: \"uk-icon uk-spinner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 36\n    }\n  }), translate.addToBasket[lang])))), __jsx(\"div\", {\n    className: \"description_product\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 17\n    }\n  }, __jsx(BlockContent, {\n    blocks: product.text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 19\n    }\n  })), __jsx(\"div\", {\n    className: \"paramets\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 17\n    }\n  }, __jsx(\"table\", {\n    className: \"uk-table uk-table-divider uk-table-small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 19\n    }\n  }, __jsx(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 21\n    }\n  }, (product.parametrs || []).map((item, index) => __jsx(\"tr\", {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 71\n    }\n  }, __jsx(\"td\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 25\n    }\n  }, item.title), __jsx(\"td\", {\n    className: \"uk-text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 25\n    }\n  }, item.value))))))))))), __jsx(ShortBlock, {\n    data: carts,\n    lang: lang,\n    currency: currency,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 7\n    }\n  }), __jsx(RandomArticles, {\n    lang: lang,\n    articleFirst: articleFirst,\n    articleSeccond: articleSeccond,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }\n  }));\n};\n\n_s(Product, \"/8VlrHCjY09CRfGg13/2kHWRpyA=\");\n\n_c = Product;\n\nconst Variant = ({\n  handle,\n  name,\n  price,\n  lang,\n  currency\n}) => {\n  return __jsx(\"li\", {\n    className: \"variant_select uk-flex\",\n    onClick: e => handle(name, price),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 5\n    }\n  }, __jsx(\"span\", {\n    className: \"uk-width-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }\n  }, name), __jsx(\"span\", {\n    className: \"uk-width-auto uk-text-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }\n  }, lang === 'en' ? (Math.round(price * 100) / 100).toFixed(2) : price, \" \", currency));\n};\n\n_c2 = Variant;\nexport var __N_SSP = true;\nexport default Product;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Product\");\n$RefreshReg$(_c2, \"Variant\");","map":{"version":3,"sources":["/Users/dmytropechunka/Desktop/work/pellwood/client/pages/produkt/[product].js"],"names":["useState","useContext","BlockContent","imageUrlBuilder","dropdown","offcanvas","Page","RandomArticles","ShortBlock","sanityClient","translate","DataStateContext","imageBuilder","urlFor","source","image","Product","carts","articleFirst","articleSeccond","product","productId","lang","currency","count","setCount","loader","setLoader","dataContextState","dataContextDispatch","select","setSelect","name","selectvariant","price","error","setError","selectHandle","hide","onBuy","variants","length","history","push","search","newBasketItem","id","nameProduct","title","variantName","variantPrice","countVariant","imgUrl","url","basket","basketCount","undefined","indexBasket","map","item","index","state","type","show","descriptionHead","titleHead","orientedImage","orientation","Math","round","toFixed","e","target","value","addToBasket","text","parametrs","Variant","handle"],"mappings":"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","sourcesContent":["import {useState, useContext} from 'react';\nimport BlockContent from \"@sanity/block-content-to-react\";\nimport imageUrlBuilder from \"@sanity/image-url\";\nimport {dropdown, offcanvas} from 'uikit'\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport ShortBlock from '../../components/SmallShortCart';\nimport sanityClient from \"../../lib/sanity.js\";\nimport translate from '../../data/staticTranslate'\nimport { DataStateContext } from '../../context/dataStateContext'\nimport localize from '../../data/localize'\nconst imageBuilder = imageUrlBuilder(sanityClient);\nconst urlFor = (source) => imageBuilder.image(source)\n\nexport async function getServerSideProps({params, locale}) {\n\n  const {lang, currency} = localize(locale)\n  const query = `{\n    'products': *[_type == \"product\" && ${lang}.slug.current == $url] {\n      _id,\n      ${lang},\n      \"linkedCarts\": *[ _type == \"product\" && _id in [^.${lang}.linkedProducts.product_1._ref, ^.${lang}.linkedProducts.product_2._ref, ^.${lang}.linkedProducts.product_3._ref]].${lang} | order(sort asc)\n    },\n    'articles': *[_type == \"article\"] | order(sort asc)\n  }`;\n  const data = await sanityClient.fetch(query, {url: params.product})\n\n  var product = data.products[0][lang]\n  if(lang === 'en'){\n    if(typeof product.price === 'string'){\n      product.price.replace(/,/g, '.')\n    }else if(product.variants?.length){\n      product.variants = product.variants.map(variant => {\n        variant.price = variant.price.replace(/,/g, '.')\n        return variant\n      })\n    }\n  }\n\n  const filteredLinedcards = data.products[0].linkedCarts.filter(item => item?.title)\n  if(lang === 'en'){\n    filteredLinedcards.map(item => {\n      if(typeof item.price === 'string'){\n        item.price.replace(/,/g, '.')\n      }else if(item.variants?.length){\n        item.variants = item.variants.map(variant => {\n          variant.price = variant.price.replace(/,/g, '.')\n          return variant\n        })\n      }\n    })\n  }\n\n  const shuffle = (a, count) => {\n    for (let i = a.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a\n  }\n\n  const articlesFilteredFirst = data.articles.filter(item => item[lang]?.category._ref.includes(\"3252355e-13f2-4628-8db4-a90bb522713b\"))\n  const articlesFilteredSeccond = data.articles.filter(item => item[lang]?.category._ref.includes(\"53b17b89-299c-48b1-b332-26240fc0e624\"))\n\n  return {\n    props: {\n      carts: filteredLinedcards,\n      articleFirst: shuffle(articlesFilteredFirst, 0),\n      articleSeccond: shuffle(articlesFilteredSeccond, 1),\n      product,\n      productId: data.products[0]._id,\n      lang,\n      currency\n    }\n  }\n}\n\nconst Product = ({\n  carts,\n  articleFirst,\n  articleSeccond,\n  product,\n  productId,\n  lang,\n  currency\n}) => {\n\n  const [count, setCount] = useState(1)\n  const [loader, setLoader] = useState(false)\n  const { dataContextState, dataContextDispatch } = useContext(DataStateContext)\n\n  const [select, setSelect] = useState({\n    name: translate.selectvariant[lang],\n    price: ''\n  })\n\n  const [error, setError] = useState({\n    select: false,\n    count: false\n  })\n\n  const selectHandle = (name, price) => {\n    setSelect({ ...select, name, price })\n    setError({ ...error, select: false })\n    dropdown(\".select-variant\").hide();\n  }\n\n  const onBuy = () => {\n    setLoader(true)\n    if(select.name === translate.selectvariant[lang] && product?.variants?.length){\n      setError({ ...error, select: true })\n      setLoader(false)\n      history.push({search: ''})\n      return;\n    }\n    if(count === 0){\n      setError({ ...error, count: true })\n      setLoader(false)\n      history.push({search: ''})\n      return;\n    }\n\n    history.push({search: '?buy=true'})\n\n    var newBasketItem = {\n      id: productId,\n      nameProduct: product.title,\n      variantName: select.name,\n      variantPrice: select.price,\n      countVariant: count,\n      imgUrl: urlFor(product.image).url()\n    }\n\n    if(!product?.variants?.length){\n      newBasketItem.variantName = product.title\n      if(typeof product.price === 'string'){\n        newBasketItem.variantPrice = product.price\n      }else{\n        newBasketItem.variantPrice = product.price\n      }\n\n    }else{\n      newBasketItem.variantName = select.name\n      newBasketItem.variantPrice = select.price\n    }\n\n    let basket = dataContextState.basket\n    let basketCount = dataContextState.basketCount\n\n    if(basket === undefined || basket === null || !basket){\n      basket = []\n      basket.push(newBasketItem)\n      basketCount = 1\n    }else{\n      let indexBasket = -1;\n      basket.map((item, index) => {\n        if(product?.variants?.length){\n          if(item.id === productId && basket[index].variantName === select.name){\n            indexBasket = index\n          }\n        }else if(item.id === productId){\n          indexBasket = index\n        }\n      })\n      if(indexBasket >= 0){\n        basket[indexBasket].countVariant = +basket[indexBasket].countVariant + count\n      }else{\n        basketCount = +basketCount + 1\n        basket.push(newBasketItem)\n      }\n      indexBasket = -1\n    }\n    dataContextDispatch({ state: basket, type: 'basket' })\n    dataContextDispatch({ state: basketCount, type: 'basketCount' })\n    offcanvas('#offcanvas-flip').show();\n    setLoader(false)\n  }\n\n  return (\n    <Page id=\"product\" description={product.descriptionHead} title={product.titleHead} image={product.orientedImage ? urlFor(product.image).orientation(270).url() : urlFor(product.image).url()}>\n      <section className=\"full product\">\n        <div className=\"uk-grid uk-child-width-1-1 uk-child-width-1-2@m\" uk-grid=\"\" uk-height-match=\"target: > div > div\">\n          <div>\n            <div className={`article_img_wrap ${product.orientedImage && 'scale_img'}`}>\n              <div className=\"uk-visible@m\">\n                {product.orientedImage\n                  ? <img src={urlFor(product.image).orientation(270).url()} alt={product.title} />\n                  : <img src={urlFor(product.image).url()} alt={product.title} />}\n              </div>\n              <div className={`uk-hidden@m ${product.orientedImage && 'orianted-img'}`}>\n                {product.orientedImage ? <img src={urlFor(product.image).orientation(180).url()} alt={product.title} />\n                : <img src={urlFor(product.image).url()} alt={product.title} />}\n              </div>\n            </div>\n          </div>\n          <div>\n            <div className=\"content_wrap grey\">\n              <div className=\"content\">\n                <h1 className=\"head_1\">{product.title}</h1>\n                {!!product?.variants?.length && <div className=\"variants_list\">\n                  {product.variants.map((item, index) => {\n                    if(item.price){\n                      return <div key={index} className=\"uk-grid uk-grid-medium\" uk-grid=\"\">\n                        <div className=\"uk-width-expand\">{item.title}</div>\n                        <div className=\"short_price\">\n                          {lang === 'en' ? (Math.round(+item.price * 100) / 100).toFixed(2) : item.price} {currency}\n                        </div>\n                      </div>\n                    }\n                    return ''\n                  })}\n                </div>}\n\n                {!!product?.variants?.[0].price && <div className=\"order_block\">\n                  <div className=\"uk-flex uk-flex-between\">\n                    <div className=\"uk-width-1-1 uk-width-auto@m\">\n                      <div className=\"custom-select-wrap\">\n                        <button className={`custom-select uk-button uk-button-default ${error.select && 'error'}`} type=\"button\" tabIndex=\"-1\">\n                          <span>{select.name}</span>\n                          <span><img src=\"/assets/chevron-down-light.svg\" alt=\"Down\" /></span>\n                        </button>\n                        <div className=\"uk-dropdown select-variant\" uk-dropdown=\"mode: click; pos: bottom-justify; offset: 0\">\n                          <ul className=\"uk-nav uk-dropdown-nav\">\n                            {(product?.variants || []).map((item, index) => <Variant key={index} lang={lang} currency={currency} handle={selectHandle} name={item.title} price={item.price} />)}\n                          </ul>\n                        </div>\n                      </div>\n                    </div>\n                    <div className={`custom_number quantity ${error.count && 'error'}`}>\n                      <input type=\"number\" min=\"1\" max=\"1000\" step=\"1\" onChange={(e) => setCount(+e.target.value)} value={count} />\n                      <div className=\"quantity-nav\">\n                        <div className=\"quantity-button quantity-up\" onClick={() => setCount(count + 1)}>+</div>\n                        <div className=\"quantity-button quantity-down\" onClick={() => {if(count > 0){ return setCount(count - 1)} else{ return false}}}>-</div>\n                      </div>\n                    </div>\n                  </div>\n                  <button\n                    className=\"uk-width-1-1 uk-margin-top tm-button tm-black-button\"\n                    onClick={() => onBuy()}>\n                    {loader && <div uk-spinner=\"\" className=\"uk-icon uk-spinner\"></div>}{translate.addToBasket[lang]}\n                  </button>\n                </div>}\n                {!product?.variants?.length && <div className=\"tm-single-order\">\n                  <div className=\"tm-single-price uk-text-center uk-margin-bottom\">{currency === '$' && currency} {product.price} {currency !== '$' && currency}</div>\n                  <div className=\"uk-grid-small uk-grid\" uk-grid=\"\">\n                    <div className=\"uk-width-1-3\">\n                      <div className={`custom_number quantity ${error.count && 'error'}`}>\n                        <input type=\"number\" min=\"1\" max=\"1000\" step=\"1\" onChange={(e) => setCount(+e.target.value)} value={count} />\n                        <div className=\"quantity-nav\">\n                          <div className=\"quantity-button quantity-up\" onClick={() => setCount(count + 1)}>+</div>\n                          <div className=\"quantity-button quantity-down\" onClick={() => {if(count > 0){ return setCount(count - 1)} else{ return false}}}>-</div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"uk-width-2-3\">\n                      <button\n                        className=\"uk-width-1-1 tm-button tm-black-button\"\n                        onClick={() => onBuy()}>\n                        {loader && <div uk-spinner=\"\" className=\"uk-icon uk-spinner\"></div>}{translate.addToBasket[lang]}\n                      </button>\n                    </div>\n                  </div>\n                </div>}\n                <div className=\"description_product\">\n                  <BlockContent blocks={product.text} />\n                </div>\n                <div className=\"paramets\">\n                  <table className=\"uk-table uk-table-divider uk-table-small\">\n                    <tbody>\n                      {(product.parametrs || []).map((item, index) => <tr key={index}>\n                        <td>{item.title}</td>\n                        <td className=\"uk-text-right\">{item.value}</td>\n                      </tr>)}\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <ShortBlock data={carts} lang={lang} currency={currency}/>\n      <RandomArticles lang={lang} articleFirst={articleFirst} articleSeccond={articleSeccond} />\n    </Page>\n  )\n\n}\n\nconst Variant = ({handle, name, price, lang, currency}) => {\n  return(\n    <li className=\"variant_select uk-flex\" onClick={e => handle(name, price)}>\n      <span className=\"uk-width-expand\" >{name}</span>\n      <span className=\"uk-width-auto uk-text-right\">{lang === 'en' ? (Math.round(price * 100) / 100).toFixed(2) : price} {currency}</span>\n    </li>\n  )\n}\n\nexport default Product\n"]},"metadata":{},"sourceType":"module"}