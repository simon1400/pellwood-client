{"ast":null,"code":"var _jsxFileName = \"/Users/dmytropechunka/Desktop/work/pellwood/client/pages/basket/checkout/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useEffect, useContext } from 'react';\nimport { AxiosAPI } from '../../../restClient';\nimport { DataStateContext } from '../../../context/dataStateContext';\nimport translate from '../../../data/staticTranslate';\nimport Page from '../../../layout/Page';\nimport { useRouter } from 'next/router';\nimport Head from '../../../components/Head';\nimport Body from '../../../components/Body';\nimport Checkout from '../../../components/Checkout';\nimport Total from '../../../components/Total';\nimport TotalEnd from '../../../components/TotalEnd';\nimport AcceptInfo from '../../../components/AcceptInfo';\nimport ButtonsSubmit from '../../../components/ButtonsSubmit';\nimport validationForm from '../../../functions/validationForm';\nimport sumTotal from '../../../functions/sumTotal';\nimport localize from '../../../data/localize';\n\nconst Basket = () => {\n  const router = useRouter();\n  const {\n    lang,\n    currency\n  } = localize(router.locale);\n  const {\n    dataContextState,\n    dataContextDispatch\n  } = useContext(DataStateContext);\n  const {\n    0: sum,\n    1: setSum\n  } = useState(0);\n  const {\n    0: sumBefore,\n    1: setSumBefore\n  } = useState(0);\n  const {\n    0: sale,\n    1: setSale\n  } = useState(0);\n  const {\n    0: basket,\n    1: setBasket\n  } = useState(dataContextState.basket);\n  const {\n    0: user,\n    1: setUser\n  } = useState(dataContextState.user);\n  const state = useState({\n    email: (user === null || user === void 0 ? void 0 : user.email) || '',\n    phone: (user === null || user === void 0 ? void 0 : user.phone) || '',\n    name: (user === null || user === void 0 ? void 0 : user.name) || '',\n    surname: (user === null || user === void 0 ? void 0 : user.surname) || '',\n    country: lang === 'cz' ? 'cz' : 'de',\n    city: (user === null || user === void 0 ? void 0 : user.city) || '',\n    address: (user === null || user === void 0 ? void 0 : user.address) || '',\n    code: (user === null || user === void 0 ? void 0 : user.code) || '',\n    anotherAddressCheck: false,\n    companyDataCheck: false,\n    registrationCheck: false,\n    noteCheck: false\n  });\n  const anotherAdress = useState({\n    email: '',\n    phone: '',\n    name: '',\n    surname: '',\n    country: lang === 'cz' ? 'cz' : 'de',\n    city: '',\n    address: '',\n    code: ''\n  });\n  const companyData = useState({\n    companyName: '',\n    ico: '',\n    dic: ''\n  });\n  const password = useState('');\n  const note = useState('');\n  const deliveryMethod = useState({\n    value: '',\n    price: '',\n    payOnline: false\n  });\n  const paymentMethod = useState({\n    value: '',\n    price: '',\n    payOnline: false\n  });\n  const {\n    0: error,\n    1: setError\n  } = useState({\n    email: false,\n    phone: false,\n    name: false,\n    surname: false,\n    city: false,\n    address: false,\n    code: false,\n    delivery: false,\n    payment: false\n  });\n  const {\n    0: errorAnother,\n    1: setErrorAnother\n  } = useState({\n    email: false,\n    phone: false,\n    name: false,\n    surname: false,\n    city: false,\n    address: false,\n    code: false\n  });\n  useEffect(() => {\n    setUser(dataContextState.user);\n    state[1](_objectSpread(_objectSpread({}, state[0]), dataContextState.user));\n  }, [dataContextState.user]);\n  useEffect(() => {\n    sumTotal(0, 0, basket, setSumBefore, setSale, setSum, lang);\n  }, []);\n  useEffect(() => {\n    sumTotal(deliveryMethod[0].price, paymentMethod[0].price, basket, setSumBefore, setSale, setSum, lang);\n  }, [deliveryMethod, paymentMethod]);\n\n  const onBlur = type => {\n    if (validationForm(type, state[0], error, setError)) {\n      return true;\n    }\n\n    return false;\n  };\n\n  const sendOrder = async () => {\n    if (!state[0].address.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        address: true\n      }));\n      return;\n    } else if (!state[0].city.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        city: true\n      }));\n      return;\n    } else if (!state[0].surname.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        surname: true\n      }));\n      return;\n    } else if (!state[0].name.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        name: true\n      }));\n      return;\n    } else if (!state[0].phone.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        phone: true\n      }));\n      return;\n    } else if (!state[0].code.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        code: true\n      }));\n      return;\n    }\n\n    if (onBlur('email')) return;\n\n    if (!deliveryMethod[0].value.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        delivery: true\n      }));\n      return;\n    }\n\n    if (!paymentMethod[0].value.length) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        payment: true\n      }));\n      return;\n    }\n\n    if (!basket.length) {\n      window.location.href = '/';\n      return;\n    }\n\n    const dataOrder = {\n      basket,\n      sum,\n      status: 'PENDING',\n      user: _objectSpread(_objectSpread({}, state[0]), {}, {\n        anotherAdress: anotherAdress[0],\n        companyData: companyData[0],\n        password: password[0]\n      }),\n      delivery: deliveryMethod[0],\n      payment: paymentMethod[0],\n      note: note[0],\n      currency: currency\n    };\n\n    if (state[0].registrationCheck) {\n      AxiosAPI.post(`${process.env.REACT_APP_API}/user`, {\n        data: dataOrder.user,\n        type: 'create'\n      }).then(res => dataContextDispatch({\n        state: res.data.data,\n        type: 'user'\n      }));\n    }\n\n    await AxiosAPI.post(`${process.env.REACT_APP_API}/order`, dataOrder).then(res => {\n      if (dataOrder.payment.payOnline) {\n        window.location.href = decodeURIComponent(res.data.data.redirect);\n      } else {\n        window.location.href = `/thank-you?refId=${res.data.data.idOrder}&dobirka=true`;\n      }\n    });\n  };\n\n  return __jsx(Page, {\n    className: \"basket\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"tm-basket-content-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"tm-basket-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }\n  }), __jsx(Checkout, {\n    state: state,\n    error: error,\n    setError: setError,\n    user: user,\n    anotherAdress: anotherAdress,\n    companyData: companyData,\n    password: password,\n    note: note,\n    deliveryMethod: deliveryMethod,\n    errorAnother: errorAnother,\n    setErrorAnother: setErrorAnother,\n    paymentMethod: paymentMethod,\n    sumBefore: sumBefore,\n    onBlur: onBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 11\n    }\n  }))), __jsx(\"div\", {\n    className: \"basket-right-panel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"basket-right-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, __jsx(TotalEnd, {\n    sum: sum,\n    basket: basket,\n    sale: sale,\n    sumBefore: sumBefore,\n    delivery: deliveryMethod[0].price,\n    payment: paymentMethod[0].price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 11\n    }\n  }), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 11\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }\n  }, translate.infovat[lang]), __jsx(AcceptInfo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 13\n    }\n  })), __jsx(\"div\", {\n    className: \"tm-basket-footer tm-footer-single total-end-footer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 11\n    }\n  }, Object.values(error).indexOf(true) >= 0 && __jsx(\"div\", {\n    className: \"uk-alert-danger uk-width-1-1 uk-text-center\",\n    \"uk-alert\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 57\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 130\n    }\n  }, translate.errorSendOrder[lang])), \"sss  \", __jsx(ButtonsSubmit, {\n    sendOrder: sendOrder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 16\n    }\n  })))));\n};\n\nexport default Basket;","map":{"version":3,"sources":["/Users/dmytropechunka/Desktop/work/pellwood/client/pages/basket/checkout/index.js"],"names":["useState","useEffect","useContext","AxiosAPI","DataStateContext","translate","Page","useRouter","Head","Body","Checkout","Total","TotalEnd","AcceptInfo","ButtonsSubmit","validationForm","sumTotal","localize","Basket","router","lang","currency","locale","dataContextState","dataContextDispatch","sum","setSum","sumBefore","setSumBefore","sale","setSale","basket","setBasket","user","setUser","state","email","phone","name","surname","country","city","address","code","anotherAddressCheck","companyDataCheck","registrationCheck","noteCheck","anotherAdress","companyData","companyName","ico","dic","password","note","deliveryMethod","value","price","payOnline","paymentMethod","error","setError","delivery","payment","errorAnother","setErrorAnother","onBlur","type","sendOrder","length","window","location","href","dataOrder","status","post","process","env","REACT_APP_API","data","then","res","decodeURIComponent","redirect","idOrder","infovat","Object","values","indexOf","errorSendOrder"],"mappings":"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","sourcesContent":["import {useState, useEffect, useContext} from 'react';\nimport {AxiosAPI} from '../../../restClient'\nimport { DataStateContext } from '../../../context/dataStateContext'\nimport translate from '../../../data/staticTranslate'\nimport Page from '../../../layout/Page'\nimport { useRouter } from 'next/router'\nimport Head from '../../../components/Head'\nimport Body from '../../../components/Body'\nimport Checkout from '../../../components/Checkout'\nimport Total from '../../../components/Total'\nimport TotalEnd from '../../../components/TotalEnd'\nimport AcceptInfo from '../../../components/AcceptInfo'\nimport ButtonsSubmit from '../../../components/ButtonsSubmit'\nimport validationForm from '../../../functions/validationForm'\nimport sumTotal from '../../../functions/sumTotal'\n\nimport localize from '../../../data/localize'\n\nconst Basket = () => {\n\n  const router = useRouter()\n  const {lang, currency} = localize(router.locale)\n  const { dataContextState, dataContextDispatch } = useContext(DataStateContext)\n  const [sum, setSum] = useState(0)\n  const [sumBefore, setSumBefore] = useState(0)\n  const [sale, setSale] = useState(0)\n  const [basket, setBasket] = useState(dataContextState.basket)\n  const [user, setUser] = useState(dataContextState.user)\n\n  const state = useState({\n    email: user?.email || '',\n    phone: user?.phone || '',\n    name: user?.name || '',\n    surname: user?.surname || '',\n    country: lang === 'cz' ? 'cz' : 'de',\n    city: user?.city || '',\n    address: user?.address || '',\n    code: user?.code || '',\n    anotherAddressCheck: false,\n    companyDataCheck: false,\n    registrationCheck: false,\n    noteCheck: false\n  })\n\n  const anotherAdress = useState({\n    email: '',\n    phone: '',\n    name: '',\n    surname: '',\n    country: lang === 'cz' ? 'cz' : 'de',\n    city: '',\n    address: '',\n    code: ''\n  })\n\n  const companyData = useState({\n    companyName: '',\n    ico: '',\n    dic: '',\n  })\n\n  const password = useState('')\n  const note = useState('')\n\n\n  const deliveryMethod = useState({\n    value: '',\n    price: '',\n    payOnline: false\n  })\n  const paymentMethod = useState({\n    value: '',\n    price: '',\n    payOnline: false\n  })\n\n  const [error, setError] = useState({\n    email: false,\n    phone: false,\n    name: false,\n    surname: false,\n    city: false,\n    address: false,\n    code: false,\n    delivery: false,\n    payment: false\n  })\n  const [errorAnother, setErrorAnother] = useState({\n    email: false,\n    phone: false,\n    name: false,\n    surname: false,\n    city: false,\n    address: false,\n    code: false\n  })\n\n  useEffect(() => {\n    setUser(dataContextState.user)\n    state[1]({...state[0], ...dataContextState.user})\n  }, [dataContextState.user])\n\n  useEffect(() => {\n    sumTotal(0, 0, basket, setSumBefore, setSale, setSum, lang)\n  }, [])\n\n  useEffect(() => {\n    sumTotal(deliveryMethod[0].price, paymentMethod[0].price, basket, setSumBefore, setSale, setSum, lang)\n  }, [deliveryMethod, paymentMethod])\n\n\n\n  const onBlur = (type) => {\n    if(validationForm(type, state[0], error, setError)) {\n      return true\n    }\n    return false\n  }\n\n\n  const sendOrder = async () => {\n\n    if(!state[0].address.length) {setError({...error, address: true}); return;}\n    else if(!state[0].city.length) {setError({...error, city: true}); return;}\n    else if(!state[0].surname.length) {setError({...error, surname: true}); return;}\n    else if(!state[0].name.length) {setError({...error, name: true}); return;}\n    else if(!state[0].phone.length) {setError({...error, phone: true}); return;}\n    else if(!state[0].code.length) {setError({...error, code: true}); return;}\n\n    if(onBlur('email')) return\n\n    if(!deliveryMethod[0].value.length){ setError({ ...error, delivery: true }); return;}\n    if(!paymentMethod[0].value.length){ setError({ ...error, payment: true }); return;}\n\n    if(!basket.length){\n      window.location.href = '/'\n      return\n    }\n\n    const dataOrder = {\n      basket,\n      sum,\n      status: 'PENDING',\n      user: {\n        ...state[0],\n        anotherAdress: anotherAdress[0],\n        companyData: companyData[0],\n        password: password[0]\n      },\n      delivery: deliveryMethod[0],\n      payment: paymentMethod[0],\n      note: note[0],\n      currency: currency\n    }\n\n    if(state[0].registrationCheck){\n      AxiosAPI.post(`${process.env.REACT_APP_API}/user`, {data: dataOrder.user, type: 'create'}).then(res =>\n        dataContextDispatch({ state: res.data.data, type: 'user' })\n      )\n    }\n\n    await AxiosAPI.post(`${process.env.REACT_APP_API}/order`, dataOrder).then(res => {\n      if(dataOrder.payment.payOnline){\n        window.location.href = decodeURIComponent(res.data.data.redirect)\n      }else{\n        window.location.href = `/thank-you?refId=${res.data.data.idOrder}&dobirka=true`\n      }\n    })\n\n  }\n\n\n  return (\n    <Page className=\"basket\">\n      <div className=\"tm-basket-content-wrap\">\n        <div className=\"tm-basket-content\">\n          <Head />\n          <Checkout\n            state={state}\n            error={error}\n            setError={setError}\n            user={user}\n            anotherAdress={anotherAdress}\n            companyData={companyData}\n            password={password}\n            note={note}\n            deliveryMethod={deliveryMethod}\n            errorAnother={errorAnother}\n            setErrorAnother={setErrorAnother}\n            paymentMethod={paymentMethod}\n            sumBefore={sumBefore}\n            onBlur={onBlur} />\n        </div>\n      </div>\n      <div className=\"basket-right-panel\">\n        <div className=\"basket-right-content\">\n          <TotalEnd\n            sum={sum}\n            basket={basket}\n            sale={sale}\n            sumBefore={sumBefore}\n            delivery={deliveryMethod[0].price}\n            payment={paymentMethod[0].price} />\n          <div>\n            <p>{translate.infovat[lang]}</p>\n            <AcceptInfo />\n          </div>\n          <div className=\"tm-basket-footer tm-footer-single total-end-footer\">\n            {Object.values(error).indexOf(true) >= 0 && <div className=\"uk-alert-danger uk-width-1-1 uk-text-center\" uk-alert=\"\"><p>{translate.errorSendOrder[lang]}</p></div>}\n          sss  <ButtonsSubmit sendOrder={sendOrder} />\n          </div>\n        </div>\n      </div>\n    </Page>\n  )\n}\nexport default Basket\n"]},"metadata":{},"sourceType":"module"}