{"ast":null,"code":"var _jsxFileName = \"/Users/dmytropechunka/Desktop/work/pellwood/client/pages/produkty/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from 'react';\nimport { modal, util } from 'uikit';\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport Cart from '../../components/Cart';\nimport SubMenu from '../../components/SubMenu';\nimport sanityClient from \"../../lib/sanity.js\";\nimport ModalFilter from '../../components/ModalFilter';\nimport translate from '../../data/staticTranslate';\nimport times from '../../assets/times.svg';\nimport localize from '../../data/localize';\nconst {\n  lang,\n  currency\n} = localize(window.location.href);\nconst query = `{\n  'product': *[_type == \"product\"].${lang} | order(${lang}.sort asc) | order(${lang}.title asc),\n  'category': *[_type == \"category\"] | order(${lang}.sort asc),\n  'articles': *[_type == \"article\"] | order(${lang}.sort asc),\n  'settings': *[_type == \"settings\"].${lang}\n}`;\nexport default (() => {\n  var _settings$metaCatalog, _settings$metaCatalog2;\n\n  const {\n    0: product,\n    1: setProduct\n  } = useState([]);\n  const {\n    0: articleFirst,\n    1: setArticleFirst\n  } = useState([]);\n  const {\n    0: articleSeccond,\n    1: setArticleSeccond\n  } = useState([]);\n  const {\n    0: category,\n    1: setCategory\n  } = useState([]);\n  const {\n    0: settings,\n    1: setSettings\n  } = useState([]);\n  const {\n    0: filtered,\n    1: setFiltered\n  } = useState(false);\n  const {\n    0: resetFilter\n  } = useState('');\n  const {\n    0: search,\n    1: setSearch\n  } = useState('');\n  const {\n    0: urlProduct,\n    1: setUrlProduct\n  } = useState(`*[_type == \"product\"].${lang}`);\n  const {\n    0: stateRange,\n    1: setStateRange\n  } = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  });\n  const {\n    0: rangeNumber,\n    1: setRangeNumber\n  } = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  });\n\n  const shuffle = (a, count) => {\n    for (let i = a.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [a[i], a[j]] = [a[j], a[i]];\n    }\n\n    if (!count) setArticleFirst(a);else setArticleSeccond(a);\n  };\n\n  const closeModal = () => {\n    modal(util.find('#modal-filter')).hide();\n  };\n\n  useEffect(() => {\n    sanityClient.fetch(query).then(data => {\n      var _data$settings$filter;\n\n      shuffle(data.articles.filter(item => {\n        var _item$lang;\n\n        return (_item$lang = item[lang]) === null || _item$lang === void 0 ? void 0 : _item$lang.category._ref.includes(\"3252355e-13f2-4628-8db4-a90bb522713b\");\n      }), 0);\n      shuffle(data.articles.filter(item => {\n        var _item$lang2;\n\n        return (_item$lang2 = item[lang]) === null || _item$lang2 === void 0 ? void 0 : _item$lang2.category._ref.includes(\"53b17b89-299c-48b1-b332-26240fc0e624\");\n      }), 1);\n      setCategory(data.category.filter(item => item === null || item === void 0 ? void 0 : item._id));\n      setSettings((_data$settings$filter = data.settings.filter(item => item === null || item === void 0 ? void 0 : item.titleCategory)) === null || _data$settings$filter === void 0 ? void 0 : _data$settings$filter[0]);\n    });\n    sanityClient.fetch(`${urlProduct} | order(sort asc, title asc)`).then(data => {\n      let filteredProduct = data.filter(item => item === null || item === void 0 ? void 0 : item.title);\n\n      if (lang === 'en') {\n        filteredProduct.map(item => {\n          var _item$variants;\n\n          if (typeof item.price === 'string') {\n            item.price.replace(/,/g, '.');\n          } else if ((_item$variants = item.variants) === null || _item$variants === void 0 ? void 0 : _item$variants.length) {\n            item.variants = item.variants.map(variant => {\n              variant.price = variant.price.replace(/,/g, '.');\n              return variant;\n            });\n          }\n        });\n      }\n\n      setProduct(filteredProduct);\n      const lengthNumbers = [],\n            diameterNumbers = [];\n      var length = undefined,\n          diameter = undefined;\n\n      for (var i = 0; i < filteredProduct.length; i++) {\n        var _filteredProduct$i;\n\n        if ((_filteredProduct$i = filteredProduct[i]) === null || _filteredProduct$i === void 0 ? void 0 : _filteredProduct$i.parametrs) {\n          var _filteredProduct$i2, _filteredProduct$i3;\n\n          length = (_filteredProduct$i2 = filteredProduct[i]) === null || _filteredProduct$i2 === void 0 ? void 0 : _filteredProduct$i2.parametrs.find(o => o.title === 'Délka' || o.title === 'Length');\n          diameter = (_filteredProduct$i3 = filteredProduct[i]) === null || _filteredProduct$i3 === void 0 ? void 0 : _filteredProduct$i3.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter');\n\n          if (length) {\n            lengthNumbers.push(+length.value.substr(0, length.value.length - 3).split(',').join('.'));\n          }\n\n          if (diameter) {\n            diameterNumbers.push(+diameter.value.substr(0, diameter.value.length - 3).split(',').join('.'));\n          }\n        }\n      }\n\n      const rangeNum = {\n        length: {\n          min: Math.min(...lengthNumbers),\n          max: Math.max(...lengthNumbers)\n        },\n        diameter: {\n          min: Math.min(...diameterNumbers),\n          max: Math.max(...diameterNumbers)\n        }\n      };\n      setRangeNumber(rangeNum);\n      setStateRange(rangeNum);\n    });\n  }, []);\n\n  const handleFilter = e => {\n    e.preventDefault();\n    const newUrlProduct = `*[_type == \"product\" ${!!search.length ? '&& ' + lang + '.title match \"' + search.split(/[,-]+/).join(' ') + '*\"' : ''}].${lang}`;\n    setUrlProduct(newUrlProduct);\n    const searchQuery = `${newUrlProduct} | order(sort asc, title asc)`;\n    sanityClient.fetch(searchQuery).then(data => {\n      const filteredProduct = data.filter(item => item === null || item === void 0 ? void 0 : item.title);\n      const filteredProdParameters = [];\n      var length = undefined,\n          diameter = undefined,\n          lengthNum = 0,\n          diameterNum = 0;\n\n      for (var i = 0; i < filteredProduct.length; i++) {\n        var _filteredProduct$i4;\n\n        if ((_filteredProduct$i4 = filteredProduct[i]) === null || _filteredProduct$i4 === void 0 ? void 0 : _filteredProduct$i4.parametrs) {\n          var _filteredProduct$i5, _filteredProduct$i6;\n\n          length = (_filteredProduct$i5 = filteredProduct[i]) === null || _filteredProduct$i5 === void 0 ? void 0 : _filteredProduct$i5.parametrs.find(o => o.title === 'Délka' || o.title === 'Length');\n          diameter = (_filteredProduct$i6 = filteredProduct[i]) === null || _filteredProduct$i6 === void 0 ? void 0 : _filteredProduct$i6.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter');\n\n          if (length || diameter) {\n            if (length) {\n              lengthNum = +length.value.substr(0, length.value.length - 3).split(',').join('.');\n            }\n\n            if (diameter) {\n              diameterNum = +diameter.value.substr(0, diameter.value.length - 3).split(',').join('.');\n            }\n\n            if (lengthNum <= stateRange.length.max && lengthNum >= stateRange.length.min && diameterNum <= stateRange.diameter.max && diameterNum >= stateRange.diameter.min) {\n              filteredProdParameters.push(filteredProduct[i]);\n            }\n          }\n        }\n      }\n\n      setProduct(filteredProdParameters);\n    });\n    closeModal();\n    setFiltered(true);\n  };\n\n  const cancelFilter = async e => {\n    e.preventDefault();\n    setFiltered(false);\n    setStateRange(rangeNumber);\n    setSearch('');\n    setUrlProduct(`*[_type == \"product\"].${lang}`);\n    const data = await sanityClient.fetch(`*[_type == \"product\"].${lang} | order(sort asc) | order(title asc)`);\n    setProduct(data); // loadMore(true, `*[_type == \"product\"].${lang}`)\n  };\n\n  return __jsx(Page, {\n    id: \"catalog\",\n    title: (_settings$metaCatalog = settings.metaCatalog) === null || _settings$metaCatalog === void 0 ? void 0 : _settings$metaCatalog.title,\n    description: (_settings$metaCatalog2 = settings.metaCatalog) === null || _settings$metaCatalog2 === void 0 ? void 0 : _settings$metaCatalog2.description,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 5\n    }\n  }, (settings === null || settings === void 0 ? void 0 : settings.titleCategory) && __jsx(\"section\", {\n    className: \"head_category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 35\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-container uk-container-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"content_head_wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 11\n    }\n  }, __jsx(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, settings.titleCategory), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }\n  }, settings.descriptionCategory)))), __jsx(\"section\", {\n    className: \"category grey\",\n    id: \"catalog-short\",\n    \"uk-filter\": \"target: .js-filter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-container uk-container-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"category_menu uk-flex uk-flex-between uk-flex-middle uk-flex-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-flex uk-flex-middle uk-width-1-1 uk-flex-between uk-flex-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"filter-controls-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 15\n    }\n  }, __jsx(\"a\", {\n    className: \"tm-button tm-black-button\",\n    href: \"#modal-filter\",\n    \"uk-toggle\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 17\n    }\n  }, translate.searchAndFilter[lang]), filtered && __jsx(\"button\", {\n    className: \"cancel-filtered tm-button tm-button-text\",\n    onClick: e => cancelFilter(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 30\n    }\n  }, __jsx(\"img\", {\n    src: times,\n    alt: \"Cancel filter\",\n    \"uk-svg\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 122\n    }\n  }), \"Zru\\u0161it v\\u0161echny filtry\")), __jsx(SubMenu, {\n    data: category,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  })))), __jsx(\"div\", {\n    className: \"uk-container uk-container-expand\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  }, __jsx(\"ul\", {\n    className: `js-filter uk-grid uk-child-width-1-1 uk-child-width-1-3@m uk-child-width-1-2@s${resetFilter ? ' show-all' : ''}`,\n    \"uk-grid\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 11\n    }\n  }, !!product.length && product.map((item, index) => __jsx(Cart, {\n    item: item,\n    key: index,\n    lang: lang,\n    currency: currency,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 63\n    }\n  }))))), __jsx(RandomArticles, {\n    lang: lang,\n    articleFirst: articleFirst,\n    articleSeccond: articleSeccond,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }\n  }), __jsx(ModalFilter, {\n    setSearch: setSearch,\n    search: search,\n    lang: lang,\n    closeModal: closeModal,\n    setStateRange: setStateRange,\n    handleFilter: handleFilter,\n    rangeNumber: rangeNumber,\n    stateRange: stateRange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }\n  }));\n});","map":{"version":3,"sources":["/Users/dmytropechunka/Desktop/work/pellwood/client/pages/produkty/index.js"],"names":["useState","useEffect","modal","util","Page","RandomArticles","Cart","SubMenu","sanityClient","ModalFilter","translate","times","localize","lang","currency","window","location","href","query","product","setProduct","articleFirst","setArticleFirst","articleSeccond","setArticleSeccond","category","setCategory","settings","setSettings","filtered","setFiltered","resetFilter","search","setSearch","urlProduct","setUrlProduct","stateRange","setStateRange","length","min","max","diameter","rangeNumber","setRangeNumber","shuffle","a","count","i","j","Math","floor","random","closeModal","find","hide","fetch","then","data","articles","filter","item","_ref","includes","_id","titleCategory","filteredProduct","title","map","price","replace","variants","variant","lengthNumbers","diameterNumbers","undefined","parametrs","o","push","value","substr","split","join","rangeNum","handleFilter","e","preventDefault","newUrlProduct","searchQuery","filteredProdParameters","lengthNum","diameterNum","cancelFilter","metaCatalog","description","descriptionCategory","searchAndFilter","index"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react';\nimport {modal, util} from 'uikit'\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport Cart from '../../components/Cart';\nimport SubMenu from '../../components/SubMenu';\nimport sanityClient from \"../../lib/sanity.js\";\nimport ModalFilter from '../../components/ModalFilter'\n\nimport translate from '../../data/staticTranslate'\nimport times from '../../assets/times.svg'\n\nimport localize from '../../data/localize'\nconst {lang, currency} = localize(window.location.href)\n\nconst query = `{\n  'product': *[_type == \"product\"].${lang} | order(${lang}.sort asc) | order(${lang}.title asc),\n  'category': *[_type == \"category\"] | order(${lang}.sort asc),\n  'articles': *[_type == \"article\"] | order(${lang}.sort asc),\n  'settings': *[_type == \"settings\"].${lang}\n}`;\n\nexport default () => {\n\n  const [product, setProduct] = useState([])\n  const [articleFirst, setArticleFirst] = useState([])\n  const [articleSeccond, setArticleSeccond] = useState([])\n  const [category, setCategory] = useState([])\n  const [settings, setSettings] = useState([])\n  const [filtered, setFiltered] = useState(false)\n  const [resetFilter] = useState('')\n  const [search, setSearch] = useState('')\n  const [urlProduct, setUrlProduct] = useState(`*[_type == \"product\"].${lang}`)\n\n  const [stateRange, setStateRange] = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  })\n\n  const [rangeNumber, setRangeNumber] = useState({\n    length: {\n      min: 0,\n      max: 45\n    },\n    diameter: {\n      min: 0,\n      max: 45\n    }\n  })\n\n  const shuffle = (a, count) => {\n    for (let i = a.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [a[i], a[j]] = [a[j], a[i]];\n    }\n\n    if(!count) setArticleFirst(a);\n    else setArticleSeccond(a);\n\n  }\n\n  const closeModal = () => {\n    modal(util.find('#modal-filter')).hide();\n  }\n\n  useEffect(() => {\n    sanityClient.fetch(query).then(data => {\n      shuffle(data.articles.filter(item => item[lang]?.category._ref.includes(\"3252355e-13f2-4628-8db4-a90bb522713b\")), 0)\n      shuffle(data.articles.filter(item => item[lang]?.category._ref.includes(\"53b17b89-299c-48b1-b332-26240fc0e624\")), 1)\n      setCategory(data.category.filter(item => item?._id))\n      setSettings(data.settings.filter(item => item?.titleCategory)?.[0])\n    })\n\n    sanityClient.fetch(`${urlProduct} | order(sort asc, title asc)`).then(data => {\n\n      let filteredProduct = data.filter(item => item?.title)\n      if(lang === 'en'){\n        filteredProduct.map(item => {\n          if(typeof item.price === 'string'){\n            item.price.replace(/,/g, '.')\n          }else if(item.variants?.length){\n            item.variants = item.variants.map(variant => {\n              variant.price = variant.price.replace(/,/g, '.')\n              return variant\n            })\n          }\n        })\n      }\n\n      setProduct(filteredProduct)\n\n      const lengthNumbers = [], diameterNumbers = []\n      var length = undefined, diameter = undefined;\n\n      for(var i = 0; i < filteredProduct.length; i++){\n        if(filteredProduct[i]?.parametrs){\n          length = filteredProduct[i]?.parametrs.find(o => o.title === 'Délka' || o.title === 'Length')\n          diameter = filteredProduct[i]?.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter')\n          if(length){\n            lengthNumbers.push(+length.value.substr(0, length.value.length - 3).split(',').join('.'))\n          }\n          if(diameter){\n            diameterNumbers.push(+diameter.value.substr(0, diameter.value.length - 3).split(',').join('.'))\n          }\n        }\n      }\n      const rangeNum = {\n        length: {\n          min: Math.min(...lengthNumbers),\n          max: Math.max(...lengthNumbers)\n        },\n        diameter: {\n          min: Math.min(...diameterNumbers),\n          max: Math.max(...diameterNumbers)\n        }\n      }\n\n      setRangeNumber(rangeNum)\n      setStateRange(rangeNum)\n    })\n  }, [])\n\n  const handleFilter = (e) => {\n    e.preventDefault()\n\n    const newUrlProduct = `*[_type == \"product\" ${!!search.length ? '&& '+lang+'.title match \"'+ search.split(/[,-]+/).join(' ') +'*\"' : ''}].${lang}`\n    setUrlProduct(newUrlProduct)\n    const searchQuery = `${newUrlProduct} | order(sort asc, title asc)`\n    sanityClient.fetch(searchQuery).then(data => {\n      const filteredProduct = data.filter(item => item?.title)\n      const filteredProdParameters = []\n      var length = undefined, diameter = undefined, lengthNum = 0, diameterNum = 0;\n\n      for(var i = 0; i < filteredProduct.length; i++){\n        if(filteredProduct[i]?.parametrs){\n          length = filteredProduct[i]?.parametrs.find(o => o.title === 'Délka' || o.title === 'Length')\n          diameter = filteredProduct[i]?.parametrs.find(o => o.title === 'Průměr' || o.title === 'Diameter')\n\n          if(length || diameter){\n            if(length){\n              lengthNum = +length.value.substr(0, length.value.length - 3).split(',').join('.')\n            }\n            if(diameter){\n              diameterNum = +diameter.value.substr(0, diameter.value.length - 3).split(',').join('.')\n            }\n            if(lengthNum <= stateRange.length.max\n              && lengthNum >= stateRange.length.min\n              && diameterNum <= stateRange.diameter.max\n              && diameterNum >= stateRange.diameter.min){\n                filteredProdParameters.push(filteredProduct[i])\n            }\n          }\n        }\n      }\n      setProduct(filteredProdParameters)\n    })\n    closeModal()\n    setFiltered(true)\n  }\n\n\n  const cancelFilter = async (e) => {\n    e.preventDefault()\n    setFiltered(false)\n    setStateRange(rangeNumber)\n    setSearch('')\n    setUrlProduct(`*[_type == \"product\"].${lang}`)\n    const data = await sanityClient.fetch(`*[_type == \"product\"].${lang} | order(sort asc) | order(title asc)`)\n    setProduct(data)\n    // loadMore(true, `*[_type == \"product\"].${lang}`)\n  }\n\n  return (\n    <Page id=\"catalog\" title={settings.metaCatalog?.title} description={settings.metaCatalog?.description}>\n      {settings?.titleCategory && <section className=\"head_category\">\n        <div className=\"uk-container uk-container-expand\">\n          <div className=\"content_head_wrap\">\n            <h1>{settings.titleCategory}</h1>\n            <p>{settings.descriptionCategory}</p>\n          </div>\n        </div>\n      </section>}\n\n\n      <section className=\"category grey\" id=\"catalog-short\" uk-filter=\"target: .js-filter\">\n        <div className=\"uk-container uk-container-expand\">\n          <div className=\"category_menu uk-flex uk-flex-between uk-flex-middle uk-flex-wrap\">\n            <div className=\"uk-flex uk-flex-middle uk-width-1-1 uk-flex-between uk-flex-wrap\">\n              <div className=\"filter-controls-wrap\">\n                <a className=\"tm-button tm-black-button\" href=\"#modal-filter\" uk-toggle=\"\">{translate.searchAndFilter[lang]}</a>\n                {filtered && <button className=\"cancel-filtered tm-button tm-button-text\" onClick={e => cancelFilter(e)}><img src={times} alt=\"Cancel filter\" uk-svg=\"\" />Zrušit všechny filtry</button>}\n              </div>\n              <SubMenu data={category}/>\n            </div>\n          </div>\n        </div>\n        <div className=\"uk-container uk-container-expand\">\n          <ul className={`js-filter uk-grid uk-child-width-1-1 uk-child-width-1-3@m uk-child-width-1-2@s${resetFilter ? ' show-all' : ''}`} uk-grid=\"\">\n            {!!product.length && product.map((item, index) => <Cart item={item} key={index} lang={lang} currency={currency} />)}\n          </ul>\n        </div>\n      </section>\n\n      <RandomArticles lang={lang} articleFirst={articleFirst} articleSeccond={articleSeccond}/>\n\n      <ModalFilter\n        setSearch={setSearch}\n        search={search}\n        lang={lang}\n        closeModal={closeModal}\n        setStateRange={setStateRange}\n        handleFilter={handleFilter}\n        rangeNumber={rangeNumber}\n        stateRange={stateRange} />\n\n    </Page>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}