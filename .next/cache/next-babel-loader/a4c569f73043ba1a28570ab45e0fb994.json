{"ast":null,"code":"import _defineProperty from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from 'react';\nimport { modal } from 'uikit';\nimport { AxiosAPI } from '../../restClient';\nimport translate from '../../data/staticTranslate';\nimport localize from '../../data/localize';\nimport { useRouter } from 'next/router';\n\nvar ResetPassword = function ResetPassword(_ref) {\n  var history = _ref.history;\n  var router = useRouter();\n\n  var _localize = localize(router.locale),\n      lang = _localize.lang;\n\n  var _useState = useState(''),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(''),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var _useState3 = useState(''),\n      confirmPassword = _useState3[0],\n      setConfirmPassword = _useState3[1];\n\n  var _useState4 = useState(false),\n      done = _useState4[0],\n      setDone = _useState4[1];\n\n  var _useState5 = useState({\n    password: false,\n    confirmPassword: false\n  }),\n      error = _useState5[0],\n      setError = _useState5[1];\n\n  useEffect(function () {\n    if (router.query.email) {\n      setEmail(Buffer.from(router.query.email, 'base64').toString());\n    }\n  }, []);\n\n  var closeModal = function closeModal() {\n    modal('#reset-password').hide();\n  };\n\n  var handleInput = function handleInput(e, type) {\n    if (type === 'password') {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: false\n      }));\n      setPassword(e.target.value);\n    }\n\n    if (type === 'confirmPassword') {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: false\n      }));\n      setConfirmPassword(e.target.value);\n    }\n  };\n\n  var _onBlur = function onBlur() {\n    if (password !== confirmPassword) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        confirmPassword: true\n      }));\n      return true;\n    }\n\n    return false;\n  };\n\n  var send = function send(e) {\n    e.preventDefault();\n    if (_onBlur()) return;\n    AxiosAPI.put(\"\".concat(process.env.REACT_APP_API, \"/user/password\"), {\n      email: email,\n      password: password\n    }).then(function (res) {\n      setDone(true);\n      history.push({\n        search: ''\n      });\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n\n  return __jsx(\"div\", {\n    id: \"reset-password\",\n    className: \"uk-flex-top\",\n    \"uk-modal\": \"\"\n  }, __jsx(\"div\", {\n    className: \"uk-modal-dialog uk-modal-body uk-margin-auto-vertical\"\n  }, __jsx(\"div\", {\n    className: \"tm-canvas-head\",\n    style: {\n      marginTop: 0\n    }\n  }, __jsx(\"h2\", null, translate.forgottenpassword[lang]), __jsx(\"button\", {\n    className: \"tm-canvas-close uk-close-large\",\n    type: \"button\",\n    \"uk-close\": \"\",\n    onClick: function onClick(e) {\n      return closeModal();\n    }\n  })), !done && __jsx(\"div\", {\n    className: \"login_form\"\n  }, __jsx(\"form\", {\n    onSubmit: function onSubmit(e) {\n      return send(e);\n    }\n  }, error.loginEmail === 'notExist' && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Zadaliste spatne email nebo heslo\")), error.loginEmail === 'exist' && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Uzivatel s timto emailem uz existuje\")), (error.loginEmail === 'empty' || error.loginPassword === 'empty') && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Vypl\\u0148te v\\u0161echna pole\")), __jsx(\"div\", {\n    className: \"uk-margin input_item\"\n  }, __jsx(\"input\", {\n    className: \"\".concat(password.length && 'hasValue', \" \").concat(error.password && 'invalid'),\n    type: \"password\",\n    value: password,\n    onChange: function onChange(e) {\n      return handleInput(e, 'password');\n    },\n    tabIndex: \"1\"\n  }), __jsx(\"label\", null, \"Nove \", translate.formpassword[lang])), __jsx(\"div\", {\n    className: \"uk-margin input_item\"\n  }, __jsx(\"input\", {\n    className: \"\".concat(confirmPassword.length && 'hasValue', \" \").concat(error.confirmPassword && 'invalid'),\n    type: \"password\",\n    onBlur: function onBlur() {\n      return _onBlur();\n    },\n    value: confirmPassword,\n    onChange: function onChange(e) {\n      return handleInput(e, 'confirmPassword');\n    },\n    tabIndex: \"2\"\n  }), __jsx(\"label\", null, \"Opakovat nove \", translate.formpassword[lang])), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"tm-button tm-black-button uk-width-1-1\"\n  }, \"Obnovit heslo\"))), done && __jsx(\"div\", {\n    className: \"uk-alert-success\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Heslo je uspesne obnoveno\"))));\n};\n\nexport default ResetPassword;","map":null,"metadata":{},"sourceType":"module"}