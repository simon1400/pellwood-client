{"ast":null,"code":"import _regeneratorRuntime from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/dmytropechunka/Desktop/work/pellwood/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useContext } from 'react';\nimport BlockContent from \"@sanity/block-content-to-react\";\nimport imageUrlBuilder from \"@sanity/image-url\";\nimport { dropdown, offcanvas } from 'uikit';\nimport Page from '../../layout/Page';\nimport RandomArticles from '../../components/RandomArticles';\nimport ShortBlock from '../../components/SmallShortCart';\nimport sanityClient from \"../../lib/sanity.js\";\nimport translate from '../../data/staticTranslate';\nimport { DataStateContext } from '../../context/dataStateContext';\nimport { useRouter } from 'next/router';\nvar imageBuilder = imageUrlBuilder(sanityClient);\n\nvar urlFor = function urlFor(source) {\n  return imageBuilder.image(source);\n};\n\nvar Product = function Product(_ref) {\n  var _product$variants4, _product$variants5, _product$variants6;\n\n  var carts = _ref.carts,\n      articleFirst = _ref.articleFirst,\n      articleSeccond = _ref.articleSeccond,\n      product = _ref.product,\n      productId = _ref.productId,\n      lang = _ref.lang,\n      currency = _ref.currency;\n  var router = useRouter();\n\n  var _useState = useState(1),\n      count = _useState[0],\n      setCount = _useState[1];\n\n  var _useState2 = useState(false),\n      loader = _useState2[0],\n      setLoader = _useState2[1];\n\n  var _useContext = useContext(DataStateContext),\n      dataContextState = _useContext.dataContextState,\n      dataContextDispatch = _useContext.dataContextDispatch;\n\n  var _useState3 = useState({\n    name: translate.selectvariant[lang],\n    price: ''\n  }),\n      select = _useState3[0],\n      setSelect = _useState3[1];\n\n  var _useState4 = useState({\n    select: false,\n    count: false\n  }),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var selectHandle = function selectHandle(name, price) {\n    setSelect(_objectSpread(_objectSpread({}, select), {}, {\n      name: name,\n      price: price\n    }));\n    setError(_objectSpread(_objectSpread({}, error), {}, {\n      select: false\n    }));\n    dropdown(\".select-variant\").hide();\n  };\n\n  var onBuy = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _product$variants, _product$variants2;\n\n      var newBasketItem, basket, basketCount, indexBasket;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoader(true);\n\n              if (!(select.name === translate.selectvariant[lang] && (product === null || product === void 0 ? void 0 : (_product$variants = product.variants) === null || _product$variants === void 0 ? void 0 : _product$variants.length))) {\n                _context.next = 6;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                select: true\n              }));\n              setLoader(false);\n              router.push(router.asPath);\n              return _context.abrupt(\"return\");\n\n            case 6:\n              if (!(count === 0)) {\n                _context.next = 11;\n                break;\n              }\n\n              setError(_objectSpread(_objectSpread({}, error), {}, {\n                count: true\n              }));\n              setLoader(false);\n              router.push(router.asPath);\n              return _context.abrupt(\"return\");\n\n            case 11:\n              router.push(router.asPath + '?buy=true');\n              newBasketItem = {\n                id: productId,\n                nameProduct: product.title,\n                variantName: select.name,\n                variantPrice: select.price,\n                countVariant: count,\n                imgUrl: urlFor(product.image).url()\n              };\n\n              if (!(product === null || product === void 0 ? void 0 : (_product$variants2 = product.variants) === null || _product$variants2 === void 0 ? void 0 : _product$variants2.length)) {\n                newBasketItem.variantName = product.title;\n\n                if (typeof product.price === 'string') {\n                  newBasketItem.variantPrice = product.price;\n                } else {\n                  newBasketItem.variantPrice = product.price;\n                }\n              } else {\n                newBasketItem.variantName = select.name;\n                newBasketItem.variantPrice = select.price;\n              }\n\n              basket = dataContextState.basket;\n              basketCount = dataContextState.basketCount;\n\n              if (basket === undefined || basket === null || !basket) {\n                basket = [];\n                basket.push(newBasketItem);\n                basketCount = 1;\n              } else {\n                indexBasket = -1;\n                basket.map(function (item, index) {\n                  var _product$variants3;\n\n                  if (product === null || product === void 0 ? void 0 : (_product$variants3 = product.variants) === null || _product$variants3 === void 0 ? void 0 : _product$variants3.length) {\n                    if (item.id === productId && basket[index].variantName === select.name) {\n                      indexBasket = index;\n                    }\n                  } else if (item.id === productId) {\n                    indexBasket = index;\n                  }\n                });\n\n                if (indexBasket >= 0) {\n                  basket[indexBasket].countVariant = +basket[indexBasket].countVariant + count;\n                } else {\n                  basketCount = +basketCount + 1;\n                  basket.push(newBasketItem);\n                }\n\n                indexBasket = -1;\n              }\n\n              dataContextDispatch({\n                state: basket,\n                type: 'basket'\n              });\n              dataContextDispatch({\n                state: basketCount,\n                type: 'basketCount'\n              });\n              _context.next = 21;\n              return offcanvas('#offcanvas-flip').show();\n\n            case 21:\n              setLoader(false);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onBuy() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Page, {\n    id: \"product\",\n    description: product.descriptionHead,\n    title: product.titleHead,\n    image: product.orientedImage ? urlFor(product.image).orientation(270).url() : urlFor(product.image).url()\n  }, __jsx(\"section\", {\n    className: \"full product\"\n  }, __jsx(\"div\", {\n    className: \"uk-grid uk-child-width-1-1 uk-child-width-1-2@m\",\n    \"uk-grid\": \"\",\n    \"uk-height-match\": \"target: > div > div\"\n  }, __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"article_img_wrap \".concat(product.orientedImage && 'scale_img')\n  }, __jsx(\"div\", {\n    className: \"uk-visible@m\"\n  }, product.orientedImage ? __jsx(\"img\", {\n    src: urlFor(product.image).orientation(270).url(),\n    alt: product.title\n  }) : __jsx(\"img\", {\n    src: urlFor(product.image).url(),\n    alt: product.title\n  })), __jsx(\"div\", {\n    className: \"uk-hidden@m \".concat(product.orientedImage && 'orianted-img')\n  }, product.orientedImage ? __jsx(\"img\", {\n    src: urlFor(product.image).orientation(180).url(),\n    alt: product.title\n  }) : __jsx(\"img\", {\n    src: urlFor(product.image).url(),\n    alt: product.title\n  })))), __jsx(\"div\", null, __jsx(\"div\", {\n    className: \"content_wrap grey\"\n  }, __jsx(\"div\", {\n    className: \"content\"\n  }, __jsx(\"h1\", {\n    className: \"head_1\"\n  }, product.title), !!(product === null || product === void 0 ? void 0 : (_product$variants4 = product.variants) === null || _product$variants4 === void 0 ? void 0 : _product$variants4.length) && __jsx(\"div\", {\n    className: \"variants_list\"\n  }, product.variants.map(function (item, index) {\n    if (item.price) {\n      return __jsx(\"div\", {\n        key: index,\n        className: \"uk-grid uk-grid-medium\",\n        \"uk-grid\": \"\"\n      }, __jsx(\"div\", {\n        className: \"uk-width-expand\"\n      }, item.title), __jsx(\"div\", {\n        className: \"short_price\"\n      }, lang === 'en' ? (Math.round(+item.price * 100) / 100).toFixed(2) : item.price, \" \", currency));\n    }\n\n    return '';\n  })), !!(product === null || product === void 0 ? void 0 : (_product$variants5 = product.variants) === null || _product$variants5 === void 0 ? void 0 : _product$variants5[0].price) && __jsx(\"div\", {\n    className: \"order_block\"\n  }, __jsx(\"div\", {\n    className: \"uk-flex uk-flex-between\"\n  }, __jsx(\"div\", {\n    className: \"uk-width-1-1 uk-width-auto@m\"\n  }, __jsx(\"div\", {\n    className: \"custom-select-wrap\"\n  }, __jsx(\"button\", {\n    className: \"custom-select uk-button uk-button-default \".concat(error.select && 'error'),\n    type: \"button\",\n    tabIndex: \"-1\"\n  }, __jsx(\"span\", null, select.name), __jsx(\"span\", null, __jsx(\"img\", {\n    src: \"/assets/chevron-down-light.svg\",\n    alt: \"Down\"\n  }))), __jsx(\"div\", {\n    className: \"uk-dropdown select-variant\",\n    \"uk-dropdown\": \"mode: click; pos: bottom-justify; offset: 0\"\n  }, __jsx(\"ul\", {\n    className: \"uk-nav uk-dropdown-nav\"\n  }, ((product === null || product === void 0 ? void 0 : product.variants) || []).map(function (item, index) {\n    return __jsx(Variant, {\n      key: index,\n      lang: lang,\n      currency: currency,\n      handle: selectHandle,\n      name: item.title,\n      price: item.price\n    });\n  }))))), __jsx(\"div\", {\n    className: \"custom_number quantity \".concat(error.count && 'error')\n  }, __jsx(\"input\", {\n    type: \"number\",\n    min: \"1\",\n    max: \"1000\",\n    step: \"1\",\n    onChange: function onChange(e) {\n      return setCount(+e.target.value);\n    },\n    value: count\n  }), __jsx(\"div\", {\n    className: \"quantity-nav\"\n  }, __jsx(\"div\", {\n    className: \"quantity-button quantity-up\",\n    onClick: function onClick() {\n      return setCount(count + 1);\n    }\n  }, \"+\"), __jsx(\"div\", {\n    className: \"quantity-button quantity-down\",\n    onClick: function onClick() {\n      if (count > 0) {\n        return setCount(count - 1);\n      } else {\n        return false;\n      }\n    }\n  }, \"-\")))), __jsx(\"button\", {\n    className: \"uk-width-1-1 uk-margin-top tm-button tm-black-button\",\n    onClick: function onClick() {\n      return onBuy();\n    }\n  }, loader && __jsx(\"div\", {\n    \"uk-spinner\": \"\",\n    className: \"uk-icon uk-spinner\"\n  }), translate.addToBasket[lang])), !(product === null || product === void 0 ? void 0 : (_product$variants6 = product.variants) === null || _product$variants6 === void 0 ? void 0 : _product$variants6.length) && __jsx(\"div\", {\n    className: \"tm-single-order\"\n  }, __jsx(\"div\", {\n    className: \"tm-single-price uk-text-center uk-margin-bottom\"\n  }, currency === '$' && currency, \" \", product.price, \" \", currency !== '$' && currency), __jsx(\"div\", {\n    className: \"uk-grid-small uk-grid\",\n    \"uk-grid\": \"\"\n  }, __jsx(\"div\", {\n    className: \"uk-width-1-3\"\n  }, __jsx(\"div\", {\n    className: \"custom_number quantity \".concat(error.count && 'error')\n  }, __jsx(\"input\", {\n    type: \"number\",\n    min: \"1\",\n    max: \"1000\",\n    step: \"1\",\n    onChange: function onChange(e) {\n      return setCount(+e.target.value);\n    },\n    value: count\n  }), __jsx(\"div\", {\n    className: \"quantity-nav\"\n  }, __jsx(\"div\", {\n    className: \"quantity-button quantity-up\",\n    onClick: function onClick() {\n      return setCount(count + 1);\n    }\n  }, \"+\"), __jsx(\"div\", {\n    className: \"quantity-button quantity-down\",\n    onClick: function onClick() {\n      if (count > 0) {\n        return setCount(count - 1);\n      } else {\n        return false;\n      }\n    }\n  }, \"-\")))), __jsx(\"div\", {\n    className: \"uk-width-2-3\"\n  }, __jsx(\"button\", {\n    className: \"uk-width-1-1 tm-button tm-black-button\",\n    onClick: function onClick() {\n      return onBuy();\n    }\n  }, loader && __jsx(\"div\", {\n    \"uk-spinner\": \"\",\n    className: \"uk-icon uk-spinner\"\n  }), translate.addToBasket[lang])))), __jsx(\"div\", {\n    className: \"description_product\"\n  }, __jsx(BlockContent, {\n    blocks: product.text\n  })), __jsx(\"div\", {\n    className: \"paramets\"\n  }, __jsx(\"table\", {\n    className: \"uk-table uk-table-divider uk-table-small\"\n  }, __jsx(\"tbody\", null, (product.parametrs || []).map(function (item, index) {\n    return __jsx(\"tr\", {\n      key: index\n    }, __jsx(\"td\", null, item.title), __jsx(\"td\", {\n      className: \"uk-text-right\"\n    }, item.value));\n  }))))))))), __jsx(ShortBlock, {\n    data: carts,\n    lang: lang,\n    currency: currency\n  }), __jsx(RandomArticles, {\n    lang: lang,\n    articleFirst: articleFirst,\n    articleSeccond: articleSeccond\n  }));\n};\n\nvar Variant = function Variant(_ref3) {\n  var handle = _ref3.handle,\n      name = _ref3.name,\n      price = _ref3.price,\n      lang = _ref3.lang,\n      currency = _ref3.currency;\n  return __jsx(\"li\", {\n    className: \"variant_select uk-flex\",\n    onClick: function onClick(e) {\n      return handle(name, price);\n    }\n  }, __jsx(\"span\", {\n    className: \"uk-width-expand\"\n  }, name), __jsx(\"span\", {\n    className: \"uk-width-auto uk-text-right\"\n  }, lang === 'en' ? (Math.round(price * 100) / 100).toFixed(2) : price, \" \", currency));\n};\n\nexport var __N_SSP = true;\nexport default Product;","map":null,"metadata":{},"sourceType":"module"}