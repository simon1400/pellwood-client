{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useEffect } from 'react';\nimport { modal } from 'uikit';\nimport { AxiosAPI } from '../../restClient';\nimport translate from '../../data/staticTranslate';\nimport localize from '../../data/localize';\nimport { useRouter } from 'next/router';\n\nconst ResetPassword = ({\n  history\n}) => {\n  const router = useRouter();\n  const {\n    lang\n  } = localize(router.locale);\n  const {\n    0: email,\n    1: setEmail\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const {\n    0: confirmPassword,\n    1: setConfirmPassword\n  } = useState('');\n  const {\n    0: done,\n    1: setDone\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState({\n    password: false,\n    confirmPassword: false\n  });\n  useEffect(() => {\n    if (router.query.email) {\n      setEmail(Buffer.from(router.query.email, 'base64').toString());\n    }\n  }, []);\n\n  const closeModal = () => {\n    modal('#reset-password').hide();\n  };\n\n  const handleInput = (e, type) => {\n    if (type === 'password') {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: false\n      }));\n      setPassword(e.target.value);\n    }\n\n    if (type === 'confirmPassword') {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: false\n      }));\n      setConfirmPassword(e.target.value);\n    }\n  };\n\n  const onBlur = () => {\n    if (password !== confirmPassword) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        confirmPassword: true\n      }));\n      return true;\n    }\n\n    return false;\n  };\n\n  const send = e => {\n    e.preventDefault();\n    if (onBlur()) return;\n    AxiosAPI.put(`${process.env.REACT_APP_API}/user/password`, {\n      email,\n      password\n    }).then(res => {\n      setDone(true);\n      history.push({\n        search: ''\n      });\n    }).catch(err => console.log(err));\n  };\n\n  return __jsx(\"div\", {\n    id: \"reset-password\",\n    className: \"uk-flex-top\",\n    \"uk-modal\": \"\"\n  }, __jsx(\"div\", {\n    className: \"uk-modal-dialog uk-modal-body uk-margin-auto-vertical\"\n  }, __jsx(\"div\", {\n    className: \"tm-canvas-head\",\n    style: {\n      marginTop: 0\n    }\n  }, __jsx(\"h2\", null, translate.forgottenpassword[lang]), __jsx(\"button\", {\n    className: \"tm-canvas-close uk-close-large\",\n    type: \"button\",\n    \"uk-close\": \"\",\n    onClick: e => closeModal()\n  })), !done && __jsx(\"div\", {\n    className: \"login_form\"\n  }, __jsx(\"form\", {\n    onSubmit: e => send(e)\n  }, error.loginEmail === 'notExist' && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Zadaliste spatne email nebo heslo\")), error.loginEmail === 'exist' && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Uzivatel s timto emailem uz existuje\")), (error.loginEmail === 'empty' || error.loginPassword === 'empty') && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Vypl\\u0148te v\\u0161echna pole\")), __jsx(\"div\", {\n    className: \"uk-margin input_item\"\n  }, __jsx(\"input\", {\n    className: `${password.length && 'hasValue'} ${error.password && 'invalid'}`,\n    type: \"password\",\n    value: password,\n    onChange: e => handleInput(e, 'password'),\n    tabIndex: \"1\"\n  }), __jsx(\"label\", null, \"Nove \", translate.formpassword[lang])), __jsx(\"div\", {\n    className: \"uk-margin input_item\"\n  }, __jsx(\"input\", {\n    className: `${confirmPassword.length && 'hasValue'} ${error.confirmPassword && 'invalid'}`,\n    type: \"password\",\n    onBlur: () => onBlur(),\n    value: confirmPassword,\n    onChange: e => handleInput(e, 'confirmPassword'),\n    tabIndex: \"2\"\n  }), __jsx(\"label\", null, \"Opakovat nove \", translate.formpassword[lang])), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"tm-button tm-black-button uk-width-1-1\"\n  }, \"Obnovit heslo\"))), done && __jsx(\"div\", {\n    className: \"uk-alert-success\",\n    \"uk-alert\": \"\"\n  }, __jsx(\"p\", null, \"Heslo je uspesne obnoveno\"))));\n};\n\nexport default ResetPassword;","map":null,"metadata":{},"sourceType":"module"}