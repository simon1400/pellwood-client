{"ast":null,"code":"var _jsxFileName = \"/Users/dmytropechunka/Desktop/work/pellwood/client/components/Login/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useContext } from 'react';\nimport { modal } from 'uikit';\nimport translate from '../../data/staticTranslate';\nimport validationForm from '../../functions/validationForm';\nimport { DataStateContext } from '../../context/dataStateContext';\nimport { AxiosAPI } from '../../restClient';\nimport { useRouter } from 'next/router';\nimport localize from '../../data/localize';\n\nconst Login = ({\n  setLoginUser\n}) => {\n  const router = useRouter();\n  const {\n    lang\n  } = localize(router.locale);\n  const {\n    dataContextDispatch\n  } = useContext(DataStateContext);\n  const {\n    0: email,\n    1: setEmail\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const {\n    0: error,\n    1: setError\n  } = useState({\n    email: false,\n    password: false\n  });\n\n  const closeModal = () => {\n    modal('#modal-login').hide();\n  };\n\n  const handleInput = (e, type) => {\n    if (type === 'email') {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        email: false\n      }));\n      setEmail(e.target.value);\n    } else if (type === 'password') {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: false\n      }));\n      setPassword(e.target.value);\n    }\n  };\n\n  const onBlur = type => {\n    if (validationForm('email', {\n      email\n    }, error, setError)) {\n      return true;\n    }\n\n    if (type === 'password' && password.length < 8 && password.length > 0) {\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: true\n      }));\n      return true;\n    }\n\n    return false;\n  };\n\n  const forgotPassword = e => {\n    e.preventDefault();\n    modal('#modal-login').hide();\n    modal('#forgot-password').show();\n  };\n\n  const onLogin = e => {\n    e.preventDefault();\n\n    if (onBlur('email') || onBlur('password')) {\n      return;\n    }\n\n    AxiosAPI.post(`/user/login`, {\n      email,\n      password\n    }).then(res => {\n      dataContextDispatch({\n        state: res.data.data,\n        type: 'user'\n      });\n      setLoginUser(true);\n      modal('#modal-login').hide();\n    }).catch(err => {\n      console.log(err.response);\n      setError(_objectSpread(_objectSpread({}, error), {}, {\n        email: 'notExist'\n      }));\n    });\n  };\n\n  const onRegister = e => {\n    e.preventDefault();\n\n    if (onBlur('email') || onBlur('password')) {\n      return;\n    }\n\n    AxiosAPI.post(`/user`, {\n      email,\n      password\n    }).then(res => {\n      var _res$data, _res$data$error, _res$data2, _res$data2$error;\n\n      if (res.data.error === 'email') setError(_objectSpread(_objectSpread({}, error), {}, {\n        email: 'exist'\n      }));else if (((_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$error = _res$data.error) === null || _res$data$error === void 0 ? void 0 : _res$data$error.indexOf('password')) >= 0) setError(_objectSpread(_objectSpread({}, error), {}, {\n        password: 'empty'\n      }));else if (((_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : (_res$data2$error = _res$data2.error) === null || _res$data2$error === void 0 ? void 0 : _res$data2$error.indexOf('email')) >= 0) setError(_objectSpread(_objectSpread({}, error), {}, {\n        email: 'empty'\n      }));else {\n        // AxiosAPI.post(`${process.env.REACT_APP_API}/sendRegistration`, {email: res.data.data.email}).then(res => console.log('send mail'))\n        dataContextDispatch({\n          state: res.data.data,\n          type: 'user'\n        });\n        setLoginUser(true);\n        router.push(\"/user\");\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  return __jsx(\"div\", {\n    id: \"modal-login\",\n    className: \"uk-flex-top\",\n    \"uk-modal\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"uk-modal-dialog uk-modal-body uk-margin-auto-vertical\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"tm-canvas-head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  }, __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, translate.login[lang]), __jsx(\"button\", {\n    className: \"tm-canvas-close uk-close-large\",\n    type: \"button\",\n    \"uk-close\": \"\",\n    onClick: e => closeModal(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    className: \"login_form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, __jsx(\"form\", {\n    onSubmit: e => onLogin(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, error.email === 'notExist' && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 44\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 15\n    }\n  }, translate.loginErrorWrong[lang])), error.email === 'exist' && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 41\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 15\n    }\n  }, translate.loginErrorExist[lang])), (error.email === 'empty' || error.password === 'empty') && __jsx(\"div\", {\n    className: \"uk-alert-danger\",\n    \"uk-alert\": \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 73\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, translate.emptyFields[lang])), __jsx(\"div\", {\n    className: \"uk-margin input_item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }, __jsx(\"input\", {\n    className: `${email.length && 'hasValue'} ${!!error.email && 'invalid'}`,\n    type: \"email\",\n    value: email,\n    onBlur: () => onBlur('email'),\n    onChange: e => handleInput(e, 'email'),\n    tabIndex: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 15\n    }\n  }), __jsx(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, translate.formemail[lang])), __jsx(\"div\", {\n    className: \"uk-margin input_item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }, __jsx(\"input\", {\n    className: `${password.length && 'hasValue'} ${(error.password || error.email === 'notExist') && 'invalid'}`,\n    type: \"password\",\n    onBlur: () => onBlur('password'),\n    value: password,\n    onChange: e => handleInput(e, 'password'),\n    tabIndex: \"2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  }), __jsx(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 15\n    }\n  }, translate.formpassword[lang])), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"tm-button tm-black-button uk-width-1-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, translate.login[lang]), __jsx(\"a\", {\n    href: \"/\",\n    onClick: e => forgotPassword(e),\n    className: \"tm-button tm-bare-button tm-button-text uk-width-1-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 123\n    }\n  }, translate.forgottenpassword[lang])), __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }), __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, translate.notyetaccount[lang]), __jsx(\"button\", {\n    className: \"tm-button tm-bare-button uk-width-1-1\",\n    onClick: e => onRegister(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 100\n    }\n  }, translate.registration[lang]))))));\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/dmytropechunka/Desktop/work/pellwood/client/components/Login/index.js"],"names":["useState","useContext","modal","translate","validationForm","DataStateContext","AxiosAPI","useRouter","localize","Login","setLoginUser","router","lang","locale","dataContextDispatch","email","setEmail","password","setPassword","error","setError","closeModal","hide","handleInput","e","type","target","value","onBlur","length","forgotPassword","preventDefault","show","onLogin","post","then","res","state","data","catch","err","console","log","response","onRegister","indexOf","push","login","loginErrorWrong","loginErrorExist","emptyFields","formemail","formpassword","forgottenpassword","notyetaccount","registration"],"mappings":"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","sourcesContent":["import {useState, useContext} from 'react'\nimport {modal} from 'uikit'\nimport translate from '../../data/staticTranslate'\nimport validationForm from '../../functions/validationForm'\nimport { DataStateContext } from '../../context/dataStateContext'\nimport {AxiosAPI} from '../../restClient'\nimport { useRouter } from 'next/router'\nimport localize from '../../data/localize'\n\nconst Login = ({setLoginUser}) => {\n\n  const router = useRouter()\n  const {lang} = localize(router.locale)\n  const { dataContextDispatch } = useContext(DataStateContext)\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [error, setError] = useState({\n    email: false,\n    password: false\n  })\n\n  const closeModal = () => {\n    modal('#modal-login').hide();\n  }\n\n  const handleInput = (e, type) => {\n    if(type === 'email'){\n      setError({ ...error, email: false})\n      setEmail(e.target.value)\n    }else if(type === 'password'){\n      setError({ ...error, password: false})\n      setPassword(e.target.value)\n    }\n  }\n\n  const onBlur = (type) => {\n    if(validationForm('email', {email}, error, setError)){\n      return true\n    }\n    if(type === 'password' && password.length < 8 && password.length > 0){\n      setError({ ...error, password: true})\n      return true\n    }\n    return false\n  }\n\n  const forgotPassword = e => {\n    e.preventDefault()\n    modal('#modal-login').hide();\n    modal('#forgot-password').show();\n  }\n\n  const onLogin = e => {\n    e.preventDefault()\n\n    if(onBlur('email') || onBlur('password')){\n      return\n    }\n\n    AxiosAPI.post(`/user/login`, { email, password }).then(res => {\n      dataContextDispatch({ state: res.data.data, type: 'user' })\n      setLoginUser(true)\n      modal('#modal-login').hide();\n    }).catch(err => {\n      console.log(err.response);\n      setError({ ...error, email: 'notExist' })\n    })\n  }\n\n  const onRegister = e => {\n    e.preventDefault()\n\n    if(onBlur('email') || onBlur('password')){\n      return\n    }\n\n    AxiosAPI.post(`/user`, { email, password }).then(res => {\n      if(res.data.error === 'email') setError({ ...error, email: 'exist' })\n      else if(res.data?.error?.indexOf('password') >= 0) setError({ ...error, password: 'empty' })\n      else if(res.data?.error?.indexOf('email') >= 0) setError({ ...error, email: 'empty' })\n      else{\n        // AxiosAPI.post(`${process.env.REACT_APP_API}/sendRegistration`, {email: res.data.data.email}).then(res => console.log('send mail'))\n        dataContextDispatch({ state: res.data.data, type: 'user' })\n        setLoginUser(true)\n\n        router.push(\"/user\")\n      }\n    }).catch(err => {\n      console.log(err);\n    })\n  }\n\n  return(\n    <div id=\"modal-login\" className=\"uk-flex-top\" uk-modal=\"\">\n      <div className=\"uk-modal-dialog uk-modal-body uk-margin-auto-vertical\">\n\n        <div className=\"tm-canvas-head\">\n          <h2>{translate.login[lang]}</h2>\n          <button className=\"tm-canvas-close uk-close-large\" type=\"button\" uk-close=\"\" onClick={e => closeModal()}></button>\n        </div>\n\n        <div className=\"login_form\">\n          <form onSubmit={e => onLogin(e)}>\n            {error.email === 'notExist' && <div className=\"uk-alert-danger\" uk-alert=\"\">\n              <p>{translate.loginErrorWrong[lang]}</p>\n            </div>}\n\n            {error.email === 'exist' && <div className=\"uk-alert-danger\" uk-alert=\"\">\n              <p>{translate.loginErrorExist[lang]}</p>\n            </div>}\n\n            {(error.email === 'empty' || error.password === 'empty') && <div className=\"uk-alert-danger\" uk-alert=\"\">\n                <p>{translate.emptyFields[lang]}</p>\n              </div>}\n\n            <div className=\"uk-margin input_item\">\n              <input\n                className={`${email.length && 'hasValue'} ${!!error.email && 'invalid'}`}\n                type=\"email\"\n                value={email}\n                onBlur={() => onBlur('email')}\n                onChange={e => handleInput(e, 'email')}\n                tabIndex=\"1\" />\n              <label>{translate.formemail[lang]}</label>\n            </div>\n            <div className=\"uk-margin input_item\">\n              <input\n                className={`${password.length && 'hasValue'} ${(error.password || error.email === 'notExist') && 'invalid'}`}\n                type=\"password\"\n                onBlur={() => onBlur('password')}\n                value={password}\n                onChange={e => handleInput(e, 'password')}\n                tabIndex=\"2\"/>\n              <label>{translate.formpassword[lang]}</label>\n            </div>\n            <button type=\"submit\" className=\"tm-button tm-black-button uk-width-1-1\">{translate.login[lang]}</button>\n            <a href=\"/\" onClick={e => forgotPassword(e)} className=\"tm-button tm-bare-button tm-button-text uk-width-1-1\"><span>{translate.forgottenpassword[lang]}</span></a>\n            <hr />\n            <p>{translate.notyetaccount[lang]}</p>\n            <button className=\"tm-button tm-bare-button uk-width-1-1\" onClick={e => onRegister(e)}><span>{translate.registration[lang]}</span></button>\n          </form>\n        </div>\n\n      </div>\n    </div>\n  )\n}\n\nexport default Login\n"]},"metadata":{},"sourceType":"module"}